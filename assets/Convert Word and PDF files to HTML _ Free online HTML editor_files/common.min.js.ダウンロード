var popupStartTime,HTML_CONTENT="htmlContent",SELECTED_DOC_ID="selectedDocID";function alert(e,t){$("#alertModalInfo").html(e),void 0!==t&&$("#alertModalTitle").html(t),$("#alertModal").modal("show"),setTimeout(function(){$("#alertModalOK").focus()},500)}function confirmModal(e,t,n,o){$("#confirmModalInfo").html(e),void 0!==o&&$("#cofirmModalTitle").html(o),$("#confirmModal").modal("show"),$("#confirmModalYes").on("click",function(){$("#confirmModal").modal("hide"),$("#confirmModalYes").unbind("click"),$("#confirmModalNo").unbind("click"),void 0!==t&&t()}),$("#confirmModalNo").on("click",function(){$("#confirmModal").modal("hide"),$("#confirmModalNo").unbind("click"),$("#confirmModalYes").unbind("click"),void 0!==n&&n()})}function showNotificationWarning(e){showNotification(e,"warning")}function showNotification(e,t){var n="glyphicon glyphicon-info-sign";null==t?t="info":"warning"!=t&&"danger"!=t||(n="glyphicon glyphicon-exclamation-sign"),$.notify({message:e,icon:n},{type:t,placement:{from:"bottom",align:"right"},animate:{enter:"animate__animated animate__fadeInDown",exit:"animate__animated animate__fadeOutUp"},delay:1e4})}function blinkElement(e){$(e).focus(),$(e).addClass("glowElement"),$(e).fadeTo(500,.7,function(){$(e).fadeTo(500,1,function(){$(e).removeClass("glowElement")})})}function showInputModal(e,t,n,o,a){$("#inputModalTitle").html(e),$("#inputName").attr("placeholder",t),null!=a&&$("#inputName").val(a),$("#inputModalInfo").html(n),$("#inputModalNextButton").off("click"),$("#inputModalNextButton").click(o),$("#inputNameModal").modal("show"),$("#inputName").focus()}function validateEmail(e){return/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(String(e).toLowerCase())}function hasHtmlBody(e){return null!==e.match(/<body[^>]*>/i)}function getTrialHTML(e,t){if(e=e.replace(/>([^<>{}]+)</gi,function(e,t){var n=new RegExp("[a-z0-1]{2,} ","gi");return">"+t.replace(n,function(e){if(85<=Math.floor(100*Math.random())){for(var t="",n=0;n<e.length-1;n++)t+="*";return t+" "}return e})+"<"}),t){t='\n<div style="color: red;">'+lajax.t('Word to HTML trial - please <a href="https://wordtohtml.net/site/payment">Go PRO</a> to get whole HTML.')+"</div>";return hasHtmlBody(e)?e.replace(/(<\/body>)/gi,t+"\n$1"):e+t}return e}function downloadTextAsFile(e,t){var n=document.createElement("a");n.setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(t)),n.setAttribute("download",e),n.style.display="none",document.body.appendChild(n),n.click(),document.body.removeChild(n)}function setOption(e,t){var n;"undefined"!=typeof Storage&&(n=getUsedSpaceOfLocalStorageInBytes(),null!==t&&(5242880<t.length||10485760<=n+t.length)?console.log("Can not store data. Current storage taken: "+n+" - tried to store "+e+" size: "+t.length):localStorage.setItem(e,t))}function getOption(e){return"undefined"!=typeof Storage?localStorage.getItem(e):null}function getBoolOption(e){return"undefined"!=typeof Storage?"true"===localStorage.getItem(e):null}function getUsedSpaceOfLocalStorageInBytes(){var e,t=0;for(e in window.localStorage)window.localStorage.hasOwnProperty(e)&&(t+=e.length+localStorage.getItem(e).length);return t}function selectOptionExists(e,t){for(var n=!1,o=t.length;o--;)if(t.options[o].value==e){n=!0;break}return n}function setCurrency(t){ajaxCall({currency:t},"/site/set-currency-ajax",function(e){"EUR"==t?($(".price-sign").html("€"),$("#currency").val("EUR"),$(".oneTimePayment").fadeIn()):("GBP"==t?($(".price-sign").html("£"),$("#currency").val("GBP")):($(".price-sign").html("$"),$("#currency").val("USD")),$(".oneTimePayment").fadeOut())})}function trackEvent(e,t,n,o){}function humanFileSize(e,t=!1,n=1){var o=t?1e3:1024;if(Math.abs(e)<o)return e+" B";var a=t?["kB","MB","GB","TB","PB","EB","ZB","YB"]:["KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"];let i=-1;for(var r=10**n;e/=o,++i,Math.round(Math.abs(e)*r)/r>=o&&i<a.length-1;);return e.toFixed(n)+" "+a[i]}function registerPopup(e,t,n){return isR||(popupStartTime=new Date,void 0!==e?trackEvent("Go PRO Popup","shown",e):trackEvent("Go PRO Popup","shown"),$("#modalWTHPro").on("hidden.bs.modal",function(){$("#modalWTHPro").unbind("hidden.bs.modal");var e=new Date-popupStartTime;ga("send","timing","GO Pro Popup","closed",e)}),void 0!==n&&$("#signUpHeading").html(n),void 0!==e&&void 0!==t?($("#featureName").html(e),$("#featureImg").prop("src",t),$("#featureImgWrapper").css("display","block"),$(".wthFeatures").css("display","none")):($("#featureImgWrapper").css("display","none"),$(".wthFeatures").css("display","block")),$("#modalWTHPro").modal("show")),!1}function checkDocFileTypeAndConvert(e){var t="",n=(t=null==e?document.getElementById("doc").value.toLowerCase():e.name).substring(t.length-4,t.length).toLowerCase();switch(n=n.replace(".","")){case"doc":case"docx":case"rtf":case"txt":case"odt":case"htm":case"html":case"pdf":return"pdf"!==n||$("#fixedHtml").is(":checked")||showNotification(lajax.t('For a more accurate visual layout enable the "Fixed HTML" option next to the green cleanup button.')),processFile(e),!0;default:return alert(lajax.t("File type not allowed.\n Allowed file types: docx, doc, pdf, rtf, txt, odt, html.")),document.getElementById("doc").value="",!1}}function dropHandler(t){if(t.preventDefault(),t.dataTransfer.items){for(let e=0;e<t.dataTransfer.items.length;e++)if("file"===t.dataTransfer.items[e].kind){checkDocFileTypeAndConvert(t.dataTransfer.items[e].getAsFile());break}}else for(let e=0;e<t.dataTransfer.files.length;e++){checkDocFileTypeAndConvert(t.dataTransfer.files[e]);break}}function dragOverHandler(e){e.preventDefault()}function showError(e,t,n){loaded(),void 0!==e.responseJSON&&void 0!==e.responseJSON.Message?alert(e.status+": "+e.statusText+", "+e.responseJSON.Message):alert(e.status+": "+e.statusText)}function saveUserNameModal(){var e=$("#userName").val().trim();0===e.length?(alert(lajax.t("Please enter your first name")),$("#userName").focus()):ajaxCall({userName:e},"/site/save-user-name-ajax",function(e){$("#userNameModal").modal("hide"),showNotification(lajax.t("Thank you for entering your first name")),void 0!==runTour&&iGuider(wthTourOpt)})}