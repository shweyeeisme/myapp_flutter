"use strict";var htmlCodeEditor,findReplaceList=[],tagAttributesList=[],docID=null,docName=null,isVisualHtmlModified=!1,templateName=null,updateVisualEditor=!1,htmlToFindReplace=null,useTiny=!1,froalaEditor=null,amazonEditor=!1,skipFirstResize=!1,froalaIconsMode=0,froalaClickedElement=null,froalaEditorHeightChange=0,visualEditorSlowHTMLUpdate=!1,inputImageToResize=null,inputImageElement=null,resizedInputImage=null,inputImageWidth=null,inputImageHeight=null,resizedImageWidth=null,resizedImageHeight=null,jpegModeFirstEvent=!1,imageToResizeInEditor=null,updateTimeoutID=0;const CODE_DARK_THEME="lesser-dark",DARK_COLOR_BG="#222",LIGHT_COLOR_BG="#fff",DARK_COLOR_FONT="#fff",LIGHT_COLOR_FONT="#000";function newDocument(){resetSharedDoc(),docID=null,$("#document").val(null).change(),setVisualEditorHtml(""),isVisualHtmlModified=!1,setOption(SELECTED_DOC_ID,docID),setOption(SELECTED_DOC_NAME,""),visualEditorSlowHTMLUpdate=!1}function resetSharedDoc(){null!==sharedDocLockIntervalID&&(clearInterval(sharedDocLockIntervalID),sharedDocLockIntervalID=null),isSharedDocument&&null!==docID&&0==isSharedDocumentLocked&&ajaxCall({documentID:docID},"/site/unlock-shared-doc-ajax"),$("#sharedDocUserInfo").html(""),isDocumentOwner=!0,setOption(IS_DOCUMENT_OWNER,isDocumentOwner),isSharedDocument=!1,setOption(IS_SHARED_DOCUMENT,isSharedDocument),isSharedDocumentLocked=!1,setOption(IS_SHARED_DOCUMENT_LOCKED,isSharedDocumentLocked),allowSharedDocumentWrite=!1,setOption(SHARED_DOCUMENT_ALLOW_WRITTING,allowSharedDocumentWrite),$("#cleanupButton").prop("disabled",!1),htmlCodeEditor.setOption("readOnly",!1),useTiny?tinymce.activeEditor.setMode("design"):froalaEditor.edit.on()}function fixWordHTML(e){return e=(e=e.replace(/(<img [^<>]+)>/gi,function(e,t){return e.includes(' border="0"')&&(e=e.replace(' border="0"',""),t=t.replace(' border="0"',"")),e.includes("alt=")?e:t+' alt="image">'})).includes("style=")?(e=(e=(e=e.replace(/margin[a-z-]*\s*:\s*undefined;/gi,"")).replace(/font-family:;/gi,"")).replace(/<td [^<>]+>/gi,function(e){var t;return e.includes('align="')&&e.includes("text-align:")&&(null!=(t=e.match(/align="([^<>"]+)"/i))&&2<=t.length&&(e=e.replace(/text-align:general/gi,"text-align:"+t[1]))),e=e.replace(/\s*(width|height|valign|align|class)="[^<>"]*"/gi,"")})).replace(/<table [^<>]+>/gi,function(e){var t;return e=fixTableSizeAttribute(e=(e=e.replace(/\s*(cellspacing|cellpadding)="0"/gi,"")).includes('border="')?(e=e.includes('border="0"')&&!e.includes("border:")?e.includes('style="')?e.replace(/style="/gi,'style="border: none;'):e.replace(/<table /gi,'<table style="border: none;" '):e).replace(/\s*border="[0-9]+"/gi,""):e,"width"),((e=fixTableSizeAttribute(e,"height")).includes('align="left"')||e.includes('align="right"'))&&(t="left",e.includes('align="right"')&&(t="right"),e=(e=e.includes('style="')?e.replace(/style="/gi,'style="float: '+t+";"):e.replace(/<table /gi,'<table style="float: '+t+'" ')).replace(/\s*align="[^<>"]*"/gi,"")),e}):e}function fixTableSizeAttribute(e,t){var a;return e.includes(t+'="')&&(e.includes(t+":")||null!=(a=e.match(new RegExp(t+'="([^<>"]+)"',"i")))&&2<=a.length&&((a=a[1]).includes("%")||(a=(.75*Number.parseFloat(a)).toPrecision(2)+"pt"),e=e.includes('style="')?e.replace(/style="/gi,'style="'+t+": "+a+";"):e.replace(/<table /gi,'<table style="'+t+": "+a+'" ')),e=e.replace(new RegExp("s*"+t+'="[^<>"]*"',"gi"),"")),e}function amazonEditorLimitCheck(e){2e3<e.length?$("#errorVisualEditor").text(lajax.t("Amazon restricts the size of your HTML to 2000 characters. You need to reduce your code by {num} characters. Please shorten it.",{num:e.length-2e3})):$("#errorVisualEditor").text("")}function getBrowserLang(){var e=window.navigator.userLanguage||window.navigator.language;return e=2<(e=null!=language?language:e).length?e.substring(0,2):e}function getBrowserWidth(){return Math.max(document.body.scrollWidth,document.documentElement.scrollWidth,document.body.offsetWidth,document.documentElement.offsetWidth,document.documentElement.clientWidth)}function checkPasteLimitForGuestUsersAndShowModal(){if(!isR){for(var e=0,t=0;t<gup.length;t++){var a=new Date,o=new Date(gup[t]);Math.floor((a-o)/36e5)<24&&e++}if(e>=mdgupc)return trackEvent("Paste Limit Modal Shown","modal"),$("#goProModalInfo").html(lajax.t("We only allow {c} paste conversions per day for free users. Go PRO now to get unlimited conversions.",{c:mdgupc})),$("#guestGoProModal").modal("show"),!0}return!1}$("document").ready(function(){useTiny=1==settings.editorType;var e={"Replace:":lajax.t("Replace:"),"Find:":lajax.t("Find:"),"With:":lajax.t("With:"),"Search:":lajax.t("Search:"),"(Use /re/ syntax for regexp search)":lajax.t("(Use /re/ syntax for regexp search)"),"Jump to line:":lajax.t("Jump to line:"),"(Use line:column or scroll% syntax)":lajax.t("(Use line:column or scroll% syntax)")};(htmlCodeEditor=CodeMirror.fromTextArea(htmlOutput,{mode:"text/html",autoCloseTags:1==settings.autoCloseTags,lineNumbers:1==settings.showLineNumbers,lineWrapping:1==settings.lineWrappig,foldGutter:1==settings.codeFolding,gutters:["CodeMirror-linenumbers","CodeMirror-foldgutter"],matchBrackets:!0,phrases:e,matchTags:!0,theme:1==settings.theme?"default":CODE_DARK_THEME,extraKeys:{"Ctrl-Space":"autocomplete","Ctrl-C":function(e){copyHtmlToClipboard()},F11:function(e){e.setOption("fullScreen",!e.getOption("fullScreen")),e.getOption("fullScreen")&&setTimeout(function(){$(".CodeMirror").css("height","100%")},100)},"Alt-F":"findPersistent",Esc:function(e){e.getOption("fullScreen")&&e.setOption("fullScreen",!1)}}})).on("copy",function(e,t){isT&&t.preventDefault(),copyHtmlToClipboard()});var a=!1;htmlCodeEditor.on("paste",function(e,t){pasteEventGA(t,"HTML Editor"),visualEditorSlowHTMLUpdate=!(a=!0)});var o;function i(e){!1===$("#fullPageMode").prop("checked")&&null!==e.match(/<body[^<>]*>/i)&&$("#fullPageMode").prop("checked",!0),amazonEditor&&amazonEditorLimitCheck(e),void 0!==froalaEditor&&void 0!==froalaEditor.html&&froalaEditor.html.set(e),a&&amazonEditor&&(contentChange(),a=!1)}function l(e){var t;tinymce.activeEditor.setContent(""),!0!==$("#fullPageMode").prop("checked")&&null===e.match(/<body[^<>]*>/i)&&null!==(t=tinymce.activeEditor.getContent().match(/([\s\S]*<body[^<>]*>)/i))&&2===t.length?tinymce.activeEditor.setContent(t[1]+e+"</body></html>"):tinymce.activeEditor.setContent(e),a&&amazonEditor&&(tinymce.execCommand("mceCleanup"),a=!1),tinymce.activeEditor.isNotDirty=!0}function n(){clearTimeout(updateTimeoutID),updateTimeoutID=0,(useTiny?l:i)(o)}if(htmlCodeEditor.on("change",function(e){var t=Date.now();o=htmlCodeEditor.getValue(),setOption(HTML_CONTENT,o),$("#htmlLength").html(o.length),updateVisualEditor&&(visualEditorSlowHTMLUpdate?(0<updateTimeoutID&&(clearTimeout(updateTimeoutID),updateTimeoutID=0),updateTimeoutID=setTimeout(n,750)):(useTiny?l:i)(o),enableFileSaving(),isVisualHtmlModified=!0),100<Date.now()-t&&(visualEditorSlowHTMLUpdate=!0)}),htmlCodeEditor.on("focus",function(e){updateVisualEditor=!0}),htmlCodeEditor.on("blur",function(e){updateVisualEditor=!1}),htmlCodeEditor.on("cursorActivity",function(e){var t=htmlCodeEditor.getCursor(),a=htmlCodeEditor.getViewport();a.from=Math.min(a.from,t.line),a.to=Math.max(t.line+1,a.to);var o,i,l=CodeMirror.findMatchingTag(htmlCodeEditor,t,a);l?("open"==l.at?l.open:l.close)&&void 0!==l.open&&null!=l.close&&(htmlToFindReplace=void 0!==l.close?htmlCodeEditor.getRange(l.open.from,l.close.to):htmlCodeEditor.getRange(l.open.from,l.open.to)):(i=htmlCodeEditor.getDoc(),o={line:t.line,ch:t.ch},l=(a=htmlCodeEditor.getSearchCursor(">",o)).findPrevious(),o=(t=htmlCodeEditor.getSearchCursor("<",o)).findNext(),htmlToFindReplace=l&&o?i.getRange(a.pos.to,t.pos.from):0<(i=i.getAllMarks()).length&&0<i[0].lines.length?i[0].lines[0].text:null)}),$("#copyCMButton").on("click",function(){copyHtmlToClipboard()}),$("#copyToClipboardButton").on("click",function(){copyHtmlToClipboard()}),$("#addToFindButton").on("click",function(){(isP||isT?addToFind:registerPopup)()}),$("#addToDeleteButton").on("click",function(){(isP||isT?addToDelete:registerPopup)()}),$("#findButton").on("click",function(){(isP||isT?findHtml:registerPopup)()}),$("#findAndReplaceButton").on("click",function(){(isP||isT?findAndReplaceHtml:registerPopup)()}),$("#undoCMButton").on("click",function(){isP||isT?(updateVisualEditor=!0,htmlCodeEditor.getDoc().undo(),setOption(HTML_CONTENT,htmlCodeEditor.getValue())):registerPopup()}),$("#redoCMButton").on("click",function(){isP||isT?(updateVisualEditor=!0,htmlCodeEditor.getDoc().redo(),setOption(HTML_CONTENT,htmlCodeEditor.getValue())):registerPopup()}),$("#showAllCMButton").on("click",function(){isP||isT?htmlCodeEditor.setOption("showInvisibles",!htmlCodeEditor.getOption("showInvisibles")):registerPopup()}),$("#fullscreeenCMButton").on("click",function(){isP||isT?(htmlCodeEditor.setOption("fullScreen",!0),setTimeout(function(){$(".CodeMirror").css("height","100%")},100)):registerPopup()}),$("#indentButton").on("click",function(){(isP||isT?indentHtml:registerPopup)()}),$("#compressButton").on("click",function(){(isP||isT?compressHtml:registerPopup)()}),$("#codeEditorFontSmallerButton").on("click",function(){(isP||isT?codeEditorFontSmaller:registerPopup)()}),$("#codeEditorFontBiggerButton").on("click",function(){(isP||isT?codeEditorFontBigger:registerPopup)()}),document.getElementById("docName").addEventListener("keypress",function(e){"Enter"===e.key&&(e.preventDefault(),document.getElementById("docSaveModalButton").click())}),document.getElementById("templateName").addEventListener("keypress",function(e){"Enter"===e.key&&(e.preventDefault(),document.getElementById("templateSaveModalButton").click())}),null!==getOption(AMAZON_MODE)&&(amazonEditor="true"==getOption(AMAZON_MODE))&&$("#editorToolbarModeOption").fadeOut(),null!=documentIDToLoad?setTimeout(function(){loadDocumentByID(documentIDToLoad)},500):null!==getOption(SELECTED_DOC_ID)&&(docID=getOption(SELECTED_DOC_ID),0!=$("#document option[value="+docID+"]").length?($("#document").val(getOption(SELECTED_DOC_ID)),getOption(SELECTED_DOC_NAME)&&(docName=getOption(SELECTED_DOC_NAME)),null!==getOption(IS_SHARED_DOCUMENT)&&(isSharedDocument=getBoolOption(IS_SHARED_DOCUMENT)),null!==getOption(IS_SHARED_DOCUMENT_LOCKED)&&(isSharedDocumentLocked=getOption(IS_SHARED_DOCUMENT_LOCKED)),null!==getOption(IS_DOCUMENT_OWNER)&&(isDocumentOwner=getBoolOption(IS_DOCUMENT_OWNER)),null!==getOption(SHARED_DOCUMENT_ALLOW_WRITTING)&&(allowSharedDocumentWrite=getBoolOption(SHARED_DOCUMENT_ALLOW_WRITTING)),h=getOption(SHARED_DOCUMENT_WITH_USERS),setDocumentSharingOptions(isSharedDocument,allowSharedDocumentWrite,JSON.parse(h)),isSharedDocument&&setTimeout(function(){loadDocument()},500)):($("#document").val(0),(docName=docID=null)!==getOption(SELECTED_DOC_ID)&&setOption(SELECTED_DOC_ID,null),$("#docSaveMenuButton").removeClass("disabled"))),useTiny){var t="",r="",s={},d=WTH_DOMAIN+"/js/spellchecker/spellchecker.php",c="English US=en,English GB=en_GB,Polski=pl",e="body { color: "+DARK_COLOR_FONT+"; background-color: "+DARK_COLOR_BG+"} .mce-content-body[data-mce-placeholder]:not(.mce-visualblocks)::before { color: #888 }";if(amazonEditor)tinymce.init({selector:"textarea.pastedContent",plugins:["lists searchreplace visualblocks visualchars ","paste fullscreen preview wordcount spellchecker nonbreaking charmap "],toolbar:"newdocument copy paste undo redo |  bold italic nonbreaking | bullist numlist | charmap spellchecker fullscreen preview ",branding:!1,menubar:!1,valid_elements:"p,strong/b,em/i,br,ul,ol,li",convert_fonts_to_spans:!1,valid_styles:[],paste_data_images:!1,remove_script_host:!1,relative_urls:!1,convert_urls:!1,allow_unsafe_link_target:!1,browser_spellcheck:!0,contextmenu:!1,spellchecker_rpc_url:d,spellchecker_languages:c,plugin_preview_height:.8*$(window).height(),plugin_preview_width:.8*$(window).width(),resize:!(!isP&&!isT),entity_encoding:settings.entityEncoding,height:null!==getOption(EDITORS_HEIGHT)&&(isP||isT)?getOption(EDITORS_HEIGHT):"450",min_height:200,language:language,skin:"2"==settings.theme?"oxide-dark":"oxide",content_style:"2"==settings.theme?e:"",save_onsavecallback:function(){return!1},setup:function(a){a.on("change",function(e){updateVisualEditor=!1,htmlCodeEditor.setValue(getVisualEditorHtml()),a.isNotDirty=!1;var t=htmlCodeEditor.getValue();setOption(HTML_CONTENT,t),enableFileSaving(),amazonEditorLimitCheck(t)}),a.on("dirty",function(e){updateVisualEditor=!1,htmlCodeEditor.setValue(getVisualEditorHtml()),enableFileSaving()}),a.on("paste",function(e){pasteEventGA(e,"Content Editor")}),a.on("undo",function(e){updateVisualEditor=!1,htmlCodeEditor.setValue(getVisualEditorHtml())}),a.on("redo",function(e){updateVisualEditor=!1,htmlCodeEditor.setValue(getVisualEditorHtml())}),a.on("copy",function(e){isT&&copyHtmlToClipboardFromVisualEditorTrialMode()&&e.preventDefault()}),a.on("ExecCommand",function(e){"mceNewDocument"===e.command?newDocument():"mceSave"===e.command&&(null!==docID?saveDoc:saveAsNewDocModal)()}),a.on("init",function(e){null!==getOption(HTML_CONTENT)&&(isP||isT)&&(updateVisualEditor=!0,htmlCodeEditor.setValue(getOption(HTML_CONTENT))),$(a.getWin()).bind("resize",function(e){(isP||isT)&&setOption(EDITORS_HEIGHT,a.getContainer().offsetHeight),setCodeEditorHeight(a.getContainer().offsetHeight)}),null!==getOption(EDITORS_HEIGHT)&&(isP||isT)&&setCodeEditorHeight(a.getContainer().offsetHeight)})}});else{1==settings.legacyHtml&&(t+="legacyoutput "),1==settings.autoLink&&(t+="autolink "),(isP||isT)&&(t+="fullpage fullscreen preview spellchecker imagetools wordcount toc responsivefilemanager charmap codesample hr nonbreaking importcss template help emoticons"),(isP||isT)&&(s={filemanager:"/js/filemanager/plugin.min.js"});var p="Andale Mono=andale mono,times;Arial=arial,helvetica,sans-serif;Arial Black=arial black,avant garde;Book Antiqua=book antiqua,palatino;Calibri=calibri,sans-serif;Comic Sans MS=comic sans ms,sans-serif;Courier New=courier new,courier;Georgia=georgia,palatino;Helvetica=helvetica;Impact=impact,chicago;Symbol=symbol;Tahoma=tahoma,arial,helvetica,sans-serif;Terminal=terminal,monaco;Times New Roman=times new roman,times;Trebuchet MS=trebuchet ms,geneva;Verdana=verdana,geneva;Webdings=webdings;Wingdings=wingdings,zapf dingbats";if(isP||isT){if(r+="responsivefilemanager charmap spellchecker preview toc ai_writer ",p="Andale Mono=andale mono,times;Arial=arial,helvetica,sans-serif;Arial Black=arial black,avant garde;Book Antiqua=book antiqua,palatino;Calibri=calibri,sans-serif;Comic Sans MS=comic sans ms,sans-serif;Courier New=courier new,courier;Georgia=georgia,palatino;Helvetica=helvetica;Impact=impact,chicago;Symbol=symbol;Tahoma=tahoma,arial,helvetica,sans-serif;Terminal=terminal,monaco;Times New Roman=times new roman,times;Trebuchet MS=trebuchet ms,geneva;Simplified Arabic=simplified arabic;Verdana=verdana,geneva;Webdings=webdings;Wingdings=wingdings,zapf dingbats",void 0!==settings.customFontNames&&0<settings.customFontNames.trim().length)for(var m=settings.customFontNames.trim().split("#"),u=0;u<m.length;u++)p=m[u].trim()+"="+m[u].trim()+";"+p}else r+="filemanager_guest spellchecker_guest ";var g=(new Date).getTime(),h="";void 0!==settings.customFontUrls&&(h=settings.customFontUrls.replace(/,/g,"%2C").replace(/#/g,",")),void 0!==settings.customCss&&0<settings.customCss.trim().length&&(0<h.length&&(h+=","),h+=settings.customCss.trim()+"?"+g),tinymce.init({selector:"textarea.pastedContent",plugins:["advlist lists link image anchor directionality ","searchreplace visualblocks visualchars pagebreak print ","insertdatetime media table paste "+t],toolbar:(isP||isT?"newdocument":"")+" copy paste undo redo  styleselect fontsizeselect fontselect forecolor backcolor | bold italic underline "+(isP?"subscript superscript blockquote | template":"")+" | \n                alignleft aligncenter alignright alignjustify "+(isP||isT?"alignnone lineheight removeformat nonbreaking":"")+" | bullist numlist outdent indent | link image emoticons "+(isP||isT?"hr":"")+" | fullscreen codesample | ltr rtl fullpage "+r,branding:!1,paste_postprocess:function(e,t){t.wordContent&&(t.node.innerHTML=t.node.innerHTML.replace(/(<li [^<>]*)style="[^"<>]+"/gi,"$1"))},paste_data_images:!0,imagetools_proxy:"/proxy.php",image_advtab:!(!isP&&!isT),image_caption:!(!isP&&!isT),image_title:!(!isP&&!isT),images_upload_handler:function(e,t,a){var o,i;$("#embedImages").is(":checked")||!1===isR?t("data:"+e.blob().type+";base64,"+e.base64()):((o=new XMLHttpRequest).withCredentials=!1,o.open("POST","/site/upload-image"),o.onload=function(){var e;200===o.status?(e=JSON.parse(o.responseText))&&"string"==typeof e.location?(t(e.location),updateVisualEditor=!1,htmlCodeEditor.setValue(getVisualEditorHtml())):a("Invalid JSON: "+o.responseText):a("HTTP Error: "+o.status)},(i=new FormData).append("file",e.blob(),e.filename()),o.send(i))},style_formats_merge:!0,style_formats:[{title:"Containers",items:[{title:"Section",block:"section",wrapper:!0,merge_siblings:!1},{title:"Article",block:"article",wrapper:!0,merge_siblings:!1},{title:"Blockquote",block:"blockquote",wrapper:!0},{title:"Header",block:"header",wrapper:!0},{title:"Main",block:"main",wrapper:!0},{title:"Footer",block:"footer",wrapper:!0},{title:"Hgroup",block:"hgroup",wrapper:!0},{title:"Aside",block:"aside",wrapper:!0},{title:"Figure",block:"figure",wrapper:!0}]}],importcss_selector_filter:"",language:language,remove_script_host:!1,relative_urls:!1,convert_urls:!1,importcss_append:!0,allow_unsafe_link_target:!0,external_filemanager_path:"/js/filemanager/",filemanager_title:lajax.t("Images manager"),browser_spellcheck:!0,contextmenu:!1,extended_valid_elements:"*[*]",spellchecker_rpc_url:d,spellchecker_languages:c,plugin_preview_height:.8*$(window).height(),plugin_preview_width:.8*$(window).width(),external_plugins:s,removed_menuitems:isP||isT?"":"removeformat, code",resize:!(!isP&&!isT),entity_encoding:settings.entityEncoding,content_css:isP||isT?h:"",content_style:"2"==settings.theme?e:"",font_formats:p,fontsize_formats:"8pt 9pt 10pt 11pt 12pt 13pt 14pt 15pt 16pt 17pt 18pt 19pt 20pt 22pt 24pt 26pt 28pt 30pt 36pt",toolbar_mode:"sliding",placeholder:lajax.t("Please start typing or paste content..."),height:null!==getOption(EDITORS_HEIGHT)&&(isP||isT)?getOption(EDITORS_HEIGHT):"450",min_height:200,mobile:{theme:"mobile",plugins:["lists","autolink"],toolbar:isP||isT?["undo","redo","bold","italic","underline","link","image","bullist","numlist","fontsizeselect","forecolor","styleselect","removeformat"]:["undo","redo","bold","italic","underline","link","bullist","numlist","fontsizeselect","styleselect"]},skin:"2"==settings.theme?"oxide-dark":"oxide",templates:[{title:"Simple email signature (no logo)",description:"Simple email signature",url:"/templates/signature_simple.html?"+g},{title:"Email signature - logo left",description:"Email signature with logo on the left side and social icons at the bottom",url:"/templates/signature_logo_left.html?"+g},{title:"Email signature - logo top",description:"Email signature with logo at the top and social icons at the bottom",url:"/templates/signature_logo_top.html?"+g}],template_popup_height:.8*$(window).height(),template_popup_width:.8*$(window).width(),save_onsavecallback:function(){return!1},setup:function(t){t.on("change",function(e){updateVisualEditor=!1,contentChange(),t.isNotDirty=!1}),t.on("dirty",function(e){updateVisualEditor=!1,htmlCodeEditor.setValue(getVisualEditorHtml()),enableFileSaving()}),t.on("paste",function(e){var t=pasteHTMLIntoVisualEditor(e);return isR||(e=new Date,gup.push(e.toISOString()),ajaxSilentCall({},"/site/guest-paste-ajax")),t}),t.on("undo",function(e){updateVisualEditor=!1,htmlCodeEditor.setValue(getVisualEditorHtml())}),t.on("redo",function(e){updateVisualEditor=!1,htmlCodeEditor.setValue(getVisualEditorHtml())}),t.on("copy",function(e){if(isT&&copyHtmlToClipboardFromVisualEditorTrialMode())return e.preventDefault(),!1}),t.on("NodeChange",function(e){(isP||isT)&&e.selectionChange&&1==settings.gotoHtmlElement&&0==onlyShowVisualEditorMode&&1215<window.outerWidth&&selectHtmlEditorElement(e.element,!1)}),t.on("ExecCommand",function(e){"mceNewDocument"===e.command?newDocument():"mceSave"===e.command&&(null!==docID?saveDoc:saveAsNewDocModal)()}),isR&&t.ui.registry.addButton("ai_writer",{icon:"edit-block",tooltip:AI_TOOLTIP,onAction:function(){showAIModal()}}),isT||(t.ui.registry.addButton("filemanager_guest",{icon:"browse",tooltip:lajax.t("Images manager"),onAction:function(){alert(lajax.t("To use images manager please GO PRO..."))}}),t.ui.registry.addButton("spellchecker_guest",{icon:"spell-check",tooltip:lajax.t("Spellchecker"),onAction:function(){alert(lajax.t("To use spellchecker please GO PRO..."))}})),t.on("init",function(e){null!==getOption(HTML_CONTENT)&&(updateVisualEditor=!0,htmlCodeEditor.setValue(getOption(HTML_CONTENT))),$(t.getWin()).bind("resize",function(e){(isP||isT)&&setOption(EDITORS_HEIGHT,t.getContainer().offsetHeight),setCodeEditorHeight(t.getContainer().offsetHeight)}),null!==getOption(EDITORS_HEIGHT)&&(isP||isT)&&setCodeEditorHeight(t.getContainer().offsetHeight),1==settings.keepAllStyles&&(t.settings.paste_retain_style_properties="all")})}})}$("#editorToolbarModeOption").css("display","none")}else isR&&(1==settings.compactToolbar?$("#editorToolbarMode").removeAttr("checked"):$("#editorToolbarMode").prop("checked",!0)),$("#visualEditor").sizeChanged(function(e){onlyShowVisualEditorMode&&(1400<window.innerWidth?($("#visualEditor").removeClass("col-lg-12"),$("#visualEditor").addClass("col-lg-10"),$("#visualEditor").addClass("col-lg-offset-1")):($("#visualEditor").removeClass("col-lg-10"),$("#visualEditor").removeClass("col-lg-offset-1"),$("#visualEditor").addClass("col-lg-12")));var t=froalaIconsMode;froalaIconsMode=e.width<800?1:0,skipFirstResize?skipFirstResize=!1:1!=settings.compactToolbar&&(null==froalaEditor||froalaEditor.fullscreen.isActive()||t!=froalaIconsMode&&(skipFirstResize=!0,froalaEditor.destroy(),setupFroalaEditor()))}),setupFroalaEditor();setupCustomJSEditor(),(isP||isT)&&(setCleanupOptionFromLocalStorage(EMBED_IMAGES),setCleanupOptionFromLocalStorage(FULL_PAGE_MODE),setCleanupOptionFromLocalStorage(HTML_FIXED_MODE),null!==getOption(HTML_CONTENT)&&htmlCodeEditor.setValue(getOption(HTML_CONTENT)),null===getOption(EDITORS_SIZE)||onlyShowVisualEditorMode||(editorSize=getOption(EDITORS_SIZE),changeEditorsSize(parseInt(editorSize))),1==settings.autoSaveHTML&&setInterval(autosaveDoc,3e5),amazonEditor?(resetTemplateOptions(),setAllCleanupOptions(!0),$("#removePTags").prop("checked",!1),$("#amazonEditorMode").prop("checked",!0),hideAmazonModeAdvacedSections()):(setCleanupOptionFromLocalStorage(REMOVE_FORMATTING),setCleanupOptionFromLocalStorage(REMOVE_CLASSES),setCleanupOptionFromLocalStorage(REMOVE_SPAN_TAGS),setCleanupOptionFromLocalStorage(REMOVE_P_TAGS),setCleanupOptionFromLocalStorage(REMOVE_IDS),setCleanupOptionFromLocalStorage(REMOVE_SCRIPTS),setCleanupOptionFromLocalStorage(REMOVE_IMAGES),setCleanupOptionFromLocalStorage(REMOVE_LINKS),setCleanupOptionFromLocalStorage(REMOVE_TABLES),setCleanupOptionFromLocalStorage(REMOVE_FORMS),setCleanupOptionFromLocalStorage(REMOVE_ANY_EMPTY_TAG),setCleanupOptionFromLocalStorage(REMOVE_TAGS_WITH_WHITESPACE),setCleanupOptionFromLocalStorage(REMOVE_ALL_TAG_ATTRIBUTES),setCleanupOptionFromLocalStorage(REMOVE_COMMENTS),setCleanupOptionFromLocalStorage(REMOVE_IFRAMES),setCleanupOptionFromLocalStorage(REMOVE_EMPTY_LINES),setCleanupOptionFromLocalStorage(REMOVE_EMPTY_ATTRIBUTES),setCleanupOptionFromLocalStorage(REMOVE_DATA_ATTRIBUTES),setCleanupOptionFromLocalStorage(COMPRESS_HTML),setCleanupOptionFromLocalStorage(INDENT_HTML),null!==getOption(CSS_TO_KEEP)&&""!=getOption(CSS_TO_KEEP).trim()?$("#cssToKeep").val(getOption(CSS_TO_KEEP)):null!==getOption(CSS_TO_REMOVE)&&""!=getOption(CSS_TO_REMOVE).trim()&&$("#cssToRemove").val(getOption(CSS_TO_REMOVE)),null!==getOption(CSS_CLASSES_TO_KEEP)&&""!=getOption(CSS_CLASSES_TO_KEEP)?$("#cssClassesToKeep").val(getOption(CSS_CLASSES_TO_KEEP)):null!==getOption(CSS_CLASSES_TO_REMOVE)&&""!=getOption(CSS_CLASSES_TO_REMOVE)&&$("#cssClassesToRemove").val(getOption(CSS_CLASSES_TO_REMOVE)),null!==getOption(REMOVE_FORMATTING)&&"true"===getOption(REMOVE_FORMATTING)&&($("#cssToKeep").attr("disabled",!0),$("#cssToRemove").attr("disabled",!0),updateCssStylesFields()),checkCssStyles(),checkCssClasses(),null!==getOption(FIND_REPLACE_LIST)&&(findReplaceList=JSON.parse(getOption(FIND_REPLACE_LIST)),fillInFindReplaceList(),0<findReplaceList.length&&disableCleanupButtonTooltip()),null!==getOption(TAG_ATTRIBUTES_LIST)&&(tagAttributesList=JSON.parse(getOption(TAG_ATTRIBUTES_LIST)),fillInTagAttributesList(),0<tagAttributesList.length&&disableCleanupButtonTooltip()),null!==getOption(CUSTOM_JS_PREPROCESS)&&customJSPreprocessCodeMirror.setValue(getOption(CUSTOM_JS_PREPROCESS)),null!==getOption(CUSTOM_JS)&&customJSCodeMirror.setValue(getOption(CUSTOM_JS)),null!==getOption(IS_TEMPLATE_MODIFIED)&&"true"==getOption(IS_TEMPLATE_MODIFIED)&&(isTemplateModified=!0),null===getOption(SELECTED_TEMPLATE_ID)||0<(g=getOption(SELECTED_TEMPLATE_ID))&&($("#template").val(g),loadTemplateAjaxCall(g),disableCleanupButtonTooltip())),null!==getOption(CODE_EDITOR_FONT_SIZE)&&setCodeEditorForSize(codeEditorFontSize=getOption(CODE_EDITOR_FONT_SIZE)),null!==getOption(TEST_EMAIL)?$("#sendToEmail").val(getOption(TEST_EMAIL)):void 0!==testEmail&&$("#sendToEmail").val(testEmail),null!==getOption(EMAIL_SUBJECT)&&$("#emailSubject").val(getOption(EMAIL_SUBJECT)),$("#cleanupTab input:checkbox").bind("change",function(){templateModified()}),$("#cleanupTab textarea").bind("change",function(){templateModified()}),onlyShowVisualEditorMode&&showOnlyVisualEditor())});var pasteHTMLAsTextCancelled=!1;function pasteHTMLIntoVisualEditor(e){if(checkPasteLimitForGuestUsersAndShowModal())return!1;var t=e.clipboardData.types;if(pasteHTMLAsTextCancelled=!1,!(t instanceof DOMStringList&&t.contains("text/html")||t.indexOf&&-1!==t.indexOf("text/html"))&&(t instanceof DOMStringList&&t.contains("text/plain")||t.indexOf&&-1!==t.indexOf("text/plain"))){var a=e.clipboardData.getData("text/plain"),t=a.match(/<([a-z0-9]+)[^<>]*>/i);if(null!=t&&0<t.length){if(confirm(lajax.t("We have detected that you are trying to paste HTML. Click OK to insert it as HTML or Cancel to have the code shown as text."))){t=a.match(/<body[^>]*>/i);return null!==t&&0<t.length?($("#fullPageMode").prop("checked",!0),useTiny?tinymce.activeEditor.setContent(a):froalaEditor.html.set(a)):useTiny?tinymce.activeEditor.insertContent(a):froalaEditor.html.insert(a),useTiny?tinymce.activeEditor.fire("change"):setTimeout(function(){contentChange()},50),trackEvent("Paste plain text HTML","paste"),!1}pasteHTMLAsTextCancelled=!0}}return pasteEventGA(e,useTiny?"Content Editor":"Froala Editor"),!0}var lastBlurTime=null,froalaWordPaste=!1,html5Head='<!DOCTYPE html>\n<html>\n  <head>\n        <meta charset="utf-8">\n        <meta name="viewport" content="width=device-width, initial-scale=1.0">\n        <title></title>\n   </head>\n<body>\n</body>\n</html>',copyToClipboardFromEditor=!1;const editorPlaceholder=lajax.t('Start typing or paste your text here. Or try our new <a href="javascript:void(0)" onclick="aiCallback()">AI writing tool</a> that will write for you!'),AI_TOOLTIP=lajax.t("Unlock the Power of AI - Write Quickly & Easily with Our New AI Writing Tool!");function aiCallbackToolbar(){aiCallback("toolbar")}function aiCallbackQI(){aiCallback("quick insert")}function aiCallback(e="placeholder"){isR?(showAIModal(),trackEvent("Show AI Modal",e)):registerPopup()}function setupFroalaEditor(){FroalaEditor.ICON_TEMPLATES.font_awesome_lg='<i class="fa fa-lg fa-[NAME]" aria-hidden="true"></i>',FroalaEditor.DefineIcon("newhtml",{NAME:"file-o",template:"font_awesome_lg"}),FroalaEditor.RegisterCommand("newhtml",{title:lajax.t("New Document"),focus:!1,undo:!0,refreshAfterCallback:!0,callback:function(){newDocument(),this.events.focus()}}),FroalaEditor.DefineIcon("copyhtml",{NAME:"clone",template:"font_awesome_lg"}),FroalaEditor.RegisterCommand("copyhtml",{title:lajax.t("Copy HTML to clipboard"),callback:function(){copyHtmlToClipboard()}}),FroalaEditor.DefineIcon("pastecontent",{NAME:"clipboard",template:"font_awesome_lg"}),FroalaEditor.RegisterCommand("pastecontent",{title:lajax.t("Paste from clipboard"),focus:!0,callback:function(){alert(lajax.t("To paste clipboard content please press Ctrl+V on your keyboard.")),this.events.focus()}}),FroalaEditor.DefineIcon("htmltemplates",{NAME:"file-code-o",template:"font_awesome_lg"}),FroalaEditor.RegisterCommand("htmltemplates",{title:lajax.t("HTML Templates"),callback:function(){isP||isT?($("#htmlTemplatesModal").modal("show"),trackEvent("HTM Template Modal","click")):registerPopup()}}),FroalaEditor.DefineIcon("formatPainter",{NAME:"paint-brush",template:"font_awesome_lg"}),FroalaEditor.RegisterCommand("formatPainter",{title:lajax.t("Format Painter - apply your formatting to other text. Click the text you want to copy the formatting from, then click this icon, finally click or select the text you want to apply the formatting too. You can do the same with keyboard shortcuts: Ctrl+Shift+E to copy format and Ctrl+Shift+F to apply format."),callback:function(){isR?runFormatPainter():registerPopup(lajax.t("Format painter is a Pro feature"),"/content/wp-content/uploads/format-painter.gif")}}),FroalaEditor.DefineIcon("pageStyleDefaults",{NAME:"sliders",template:"font_awesome_lg"}),FroalaEditor.RegisterCommand("pageStyleDefaults",{title:lajax.t("Page Style Defaults (background and font color, font family and size, padding, margin and page width)"),callback:function(){setPageStyleDefaultsAndShowModal(),trackEvent("Page Style Defaults modal shown","click")}}),FroalaEditor.DefineIcon("tableOptions",{NAME:"paint-brush",template:"font_awesome_lg"}),FroalaEditor.RegisterCommand("tableOptions",{title:lajax.t("Table styling"),callback:function(){tableOptionsModal(),trackEvent("Edit table styling modal shown","click")}}),FroalaEditor.DefineIcon("tableCellOptions",{NAME:"paint-brush",template:"font_awesome_lg"}),FroalaEditor.RegisterCommand("tableCellOptions",{title:lajax.t("Table cell styling"),callback:function(){tableCellOptionsModal(),trackEvent("Edit table cell styling modal shown","click")}}),FroalaEditor.DefineIcon("imageEditor",{NAME:"paint-brush",template:"font_awesome_lg"}),FroalaEditor.RegisterCommand("imageEditor",{title:lajax.t("Image editor"),callback:function(){isR?(showImageEditor(),trackEvent("Show image editor","click")):registerPopup()}}),FroalaEditor.DefineIcon("imageResize",{NAME:"compress",template:"font_awesome_lg"}),FroalaEditor.RegisterCommand("imageResize",{title:lajax.t("Make image file smaller for faster web page or email loading"),callback:function(){isR?(resizeImageModal(),trackEvent("Make image files smaller","click")):registerPopup()}}),FroalaEditor.DefineIconTemplate("image_size","<img src=[SRC] alt=[ALT] width=[WIDTH] height=[HEIGHT] />"),FroalaEditor.DefineIcon("textShadow",{SRC:"/images/shadow-text-icon.svg",template:"image_size",ALT:"shadow",WIDTH:"24px",HEIGHT:"24px"}),FroalaEditor.RegisterCommand("textShadow",{title:lajax.t("Text shadow"),callback:function(){0<froalaEditor.selection.text().length?($("#textShadowWell").css("background-color",$(froalaEditor.$el).css("background-color")),$("#textShadowPreview").css("color",$(froalaEditor.selection.element()).css("color")),$("#textShadowModal").modal("show")):alert(lajax.t("Please select some text first")),trackEvent("Text shadow","click")}}),FroalaEditor.DefineIcon("imagesManager",{NAME:"folder-open-o",template:"font_awesome_lg"}),FroalaEditor.RegisterCommand("imagesManager",{title:lajax.t("Images Manager"),callback:function(){isR?(trackEvent("Froala images manager modal shown","click"),document.getElementById("imagesManagerFrame").contentWindow.location.reload(),$("#imagesManagerModal").modal("show")):registerPopup()}}),FroalaEditor.DefineIcon("aiWriter",{NAME:"magic",template:"font_awesome_lg"}),FroalaEditor.RegisterCommand("aiWriter",{title:AI_TOOLTIP,callback:aiCallbackToolbar}),FroalaEditor.DefineIcon("aiWriterIcon",{NAME:"magic",template:"font_awesome"}),FroalaEditor.RegisterQuickInsertButton("aiWriterQuickInsert",{icon:"aiWriterIcon",title:AI_TOOLTIP,callback:aiCallbackQI,undo:!0}),FroalaEditor.DefineIcon("emojisIcon",{NAME:"smile-o",template:"font_awesome_lg"}),FroalaEditor.RegisterCommand("emojisButton",{title:lajax.t("Emojis"),icon:"emojisIcon",callback:function(){var e=$("button[data-cmd='emojisButton']");$("#emojisPopup").css("left",e.offset().left+30),$("#emojisPopup").css("top",e.offset().top+30),$("#emojisPopup").toggle(),setTimeout(function(){$("emoji-picker")[0].shadowRoot.querySelector("input").focus()},50)}}),$("emoji-picker").bind("emoji-click",function(e){froalaEditor.html.insert(e.detail.unicode),$("#emojisPopup").toggle(),contentChange()}),$("emoji-picker").bind("blur",function(e){$("#emojisPopup").hide()});function e(){amazonEditor||froalaEditor.html.set(html5Head),null!==getOption(HTML_CONTENT)&&(updateVisualEditor=!0,htmlCodeEditor.setValue(getOption(HTML_CONTENT))),setCodeEditorHeight(this.$box.outerHeight()),isR&&($(".fr-second-toolbar").prop("draggable",!0),$(".fr-second-toolbar").prop("title",lajax.t("Drag this down or up to change the Visual and Code editor height")),$(".fr-second-toolbar").on("dragstart",function(e){froalaEditorHeightChange=e.originalEvent.screenY}),$(".fr-second-toolbar").on("dragend",function(e){e=parseInt(froalaEditor.opts.height)+(e.originalEvent.screenY-froalaEditorHeightChange);froalaEditor.opts.height=(e=e<200?200:e).toString(),froalaEditor.size.refresh(),setOption(EDITORS_HEIGHT,e.toString()),setTimeout(function(){setCodeEditorHeight(froalaEditor.$box.outerHeight())},50)}))}function t(){updateVisualEditor=!1,setTimeout(function(){contentChange()},50),0==settings.editorHeight&&setCodeEditorHeight(this.$box.outerHeight())}function a(){var e;froalaWordPaste=!1,document.querySelector("#visualEditor").scrollIntoView(),isR||(e=new Date,gup.push(e.toISOString()),ajaxSilentCall({},"/site/guest-paste-ajax"))}function o(e){froalaClickedElement=e.currentTarget,(isP||isT)&&1==settings.gotoHtmlElement&&0==onlyShowVisualEditorMode&&1215<window.outerWidth&&selectHtmlEditorElement(e.currentTarget,!1),isR&&formatPainterEnabled&&applyFormatPainter()}function i(t,e){t[0].className="",delete t[0].dataset.url,froalaClickedElement=t[0],$("#embedImages").is(":checked")&&!t[0].src.startsWith("data:")?toDataUrl(t[0].src,function(e){t[0].src=e,a()}):a()}var l=getBrowserLang();FroalaEditor.VIDEO_PROVIDERS.push({test_regex:/^.*\.mp4.*/,url_regex:/(^.*\.mp4.*)/g,url_text:"$1",html:'<video width="100%" controls><source src="{url}" type="video/mp4"></video>',provider:"mp4"}),FroalaEditor.LANGUAGE.pl.translation["Background Color"]="Kolor tła",FroalaEditor.LANGUAGE.pl.translation["Text Color"]="Kolor tekstu",FroalaEditor.LANGUAGE.pl.translation.Default="Domyślnie",FroalaEditor.LANGUAGE.pl.translation["Line Height"]="Odstęp między liniami",FroalaEditor.LANGUAGE.pl.translation.Single="Pojedynczy",FroalaEditor.LANGUAGE.pl.translation.Double="Podwójny",FroalaEditor.LANGUAGE.pl.translation.Circle="Punktory okrągłe",FroalaEditor.LANGUAGE.pl.translation.Disc="Punktory dysk",FroalaEditor.LANGUAGE.pl.translation.Square="Punktory kwadratowe",FroalaEditor.LANGUAGE.pl.translation["Lower Alpha"]="Lista alfabetyczna (małe litery)",FroalaEditor.LANGUAGE.pl.translation["Lower Greek"]="Lista grecka (małe litery)",FroalaEditor.LANGUAGE.pl.translation["Lower Roman"]="Lista rzymska (małe litery)",FroalaEditor.LANGUAGE.pl.translation["Upper Alpha"]="Lista alfabetyczna (duże litery)",FroalaEditor.LANGUAGE.pl.translation["Upper Roman"]="Lista rzymska (duże litery)",FroalaEditor.LANGUAGE.pl.translation.More="Więcej",FroalaEditor.LANGUAGE.pl.translation["More Misc"]="Inne opcje",FroalaEditor.LANGUAGE.pl.translation["More Paragraph"]="Więcej opcji",FroalaEditor.LANGUAGE.pl.translation["More Rich"]="Więcej opcji",FroalaEditor.LANGUAGE.pl.translation["More Text"]="Więcej opcji formatowania tekstu",FroalaEditor.LANGUAGE.pl.translation.None="Brak",FroalaEditor.LANGUAGE.pl.translation.Display="Pozycja względem tekstu",FroalaEditor.LANGUAGE.pl.translation.Inline="W tekście",FroalaEditor.LANGUAGE.pl.translation["Break Text"]="Załam tekst",FroalaEditor.LANGUAGE.pl.translation.Replace="Zastąp",FroalaEditor.LANGUAGE.pl.translation.Remove="Usuń",FroalaEditor.LANGUAGE.pl.translation.Delete="Usuń",FroalaEditor.LANGUAGE.pl.translation.Back="Wstecz",FroalaEditor.LANGUAGE.pl.translation.Cut="Wytnij",FroalaEditor.LANGUAGE.pl.translation.Top="Góra",FroalaEditor.LANGUAGE.pl.translation.Middle="Środek",FroalaEditor.LANGUAGE.pl.translation.Bottom="Dół",FroalaEditor.LANGUAGE.pl.translation.Table="Tabela",FroalaEditor.LANGUAGE.pl.translation["Table Footer"]="Stopka Tabeli",FroalaEditor.LANGUAGE.pl.translation.Print="Drukuj",FroalaEditor.LANGUAGE.pl.translation.Paste="Wklej",FroalaEditor.LANGUAGE.pl.translation["Cell Background"]="Kolor tła komórki",FroalaEditor.LANGUAGE.pl.translation["HEX Color"]="Kolor HEX",FroalaEditor.LANGUAGE.pl.translation.Misc="Różne",FroalaEditor.LANGUAGE.pl.translation["Inline Style"]="Styl tekstu (inline CSS)",FroalaEditor.LANGUAGE.pl.translation["Paragraph Style"]="Styl akapitu (klasa CSS)",FroalaEditor.LANGUAGE.pl.translation.Increase="Zwiększ",FroalaEditor.LANGUAGE.pl.translation["Increase quote level"]="Zwięszenie poziomu cytatu",FroalaEditor.LANGUAGE.pl.translation.Decrease="Zmniejsz",FroalaEditor.LANGUAGE.pl.translation["Decrease quote level"]="Zmniejszenie poziomu cytatu",FroalaEditor.LANGUAGE.pl.translation["Resize larger"]="Zwiększ rozmiar",FroalaEditor.LANGUAGE.pl.translation["Resize smaller"]="Zmnijesz rozmiar",FroalaEditor.LANGUAGE.pl.translation["Show the editor"]="Pokaż edytor",FroalaEditor.LANGUAGE.pl.translation["Focus popup / toolbar"]="Fokus na ikony w pasku narzędzi",FroalaEditor.LANGUAGE.pl.translation["Horizontal Align"]="Poziome wyrównianie";var n="";"named"==settings.entityEncoding?n="&quot;&apos;&iexcl;&cent;&pound;&curren;&yen;&brvbar;&sect;&uml;&copy;&ordf;&laquo;&not;&shy;&reg;&macr;&deg;&plusmn;&sup2;&sup3;&acute;&micro;&para;&middot;&cedil;&sup1;&ordm;&raquo;&frac14;&frac12;&frac34;&iquest;&Agrave;&Aacute;&Acirc;&Atilde;&Auml;&Aring;&AElig;&Ccedil;&Egrave;&Eacute;&Ecirc;&Euml;&Igrave;&Iacute;&Icirc;&Iuml;&ETH;&Ntilde;&Ograve;&Oacute;&Ocirc;&Otilde;&Ouml;&times;&Oslash;&Ugrave;&Uacute;&Ucirc;&Uuml;&Yacute;&THORN;&szlig;&agrave;&aacute;&acirc;&atilde;&auml;&aring;&aelig;&ccedil;&egrave;&eacute;&ecirc;&euml;&igrave;&iacute;&icirc;&iuml;&eth;&ntilde;&ograve;&oacute;&ocirc;&otilde;&ouml;&divide;&oslash;&ugrave;&uacute;&ucirc;&uuml;&yacute;&thorn;&yuml;&OElig;&oelig;&Scaron;&scaron;&Yuml;&fnof;&circ;&tilde;&Alpha;&Beta;&Gamma;&Delta;&Epsilon;&Zeta;&Eta;&Theta;&Iota;&Kappa;&Lambda;&Mu;&Nu;&Xi;&Omicron;&Pi;&Rho;&Sigma;&Tau;&Upsilon;&Phi;&Chi;&Psi;&Omega;&alpha;&beta;&gamma;&delta;&epsilon;&zeta;&eta;&theta;&iota;&kappa;&lambda;&mu;&nu;&xi;&omicron;&pi;&rho;&sigmaf;&sigma;&tau;&upsilon;&phi;&chi;&psi;&omega;&thetasym;&upsih;&piv;&ensp;&emsp;&thinsp;&zwnj;&zwj;&lrm;&rlm;&ndash;&mdash;&lsquo;&rsquo;&sbquo;&ldquo;&rdquo;&bdquo;&dagger;&Dagger;&bull;&hellip;&permil;&prime;&Prime;&lsaquo;&rsaquo;&oline;&frasl;&euro;&image;&weierp;&real;&trade;&alefsym;&larr;&uarr;&rarr;&darr;&harr;&crarr;&lArr;&uArr;&rArr;&dArr;&hArr;&forall;&part;&exist;&empty;&nabla;&isin;&notin;&ni;&prod;&sum;&minus;&lowast;&radic;&prop;&infin;&ang;&and;&or;&cap;&cup;&int;&there4;&sim;&cong;&asymp;&ne;&equiv;&le;&ge;&sub;&sup;&nsub;&sube;&supe;&oplus;&otimes;&perp;&sdot;&lceil;&rceil;&lfloor;&rfloor;&lang;&rang;&loz;&spades;&clubs;&hearts;&diams;":"numeric"==settings.entityEncoding&&(n="&#38;&#39;&#192;&#193;&#194;&#195;&#196;&#197;&#198;&#199;&#200;&#201;&#202;&#203;&#204;&#205;&#206;&#207;&#208;&#209;&#210;&#211;&#212;&#213;&#214;&#216;&#217;&#218;&#219;&#220;&#221;&#222;&#223;&#224;&#225;&#226;&#227;&#228;&#229;&#230;&#231;&#232;&#233;&#234;&#235;&#236;&#237;&#238;&#239;&#240;&#241;&#242;&#243;&#244;&#245;&#246;&#248;&#249;&#250;&#251;&#252;&#253;&#254;&#255;&#160;&#161;&#162;&#163;&#164;&#165;&#166;&#167;&#168;&#169;&#170;&#171;&#172;&#173;&#174;&#175;&#176;&#177;&#178;&#179;&#180;&#181;&#182;&#184;&#185;&#186;&#187;&#188;&#189;&#190;&#191;&#215;&#247;&#8704;&#8706;&#8707;&#8709;&#8711;&#8712;&#8713;&#8715;&#8719;&#8721;&#8722;&#8727;&#8730;&#8733;&#8734;&#8736;&#8743;&#8744;&#8745;&#8746;&#8747;&#8756;&#8764;&#8773;&#8776;&#8800;&#8801;&#8804;&#8805;&#8834;&#8835;&#8836;&#8838;&#8839;&#8853;&#8855;&#8869;&#8901;&#913;&#914;&#915;&#916;&#917;&#918;&#919;&#920;&#921;&#922;&#923;&#924;&#925;&#926;&#927;&#928;&#929;&#931;&#932;&#933;&#934;&#935;&#936;&#937;&#945;&#946;&#947;&#948;&#949;&#950;&#951;&#952;&#953;&#954;&#955;&#956;&#957;&#958;&#959;&#960;&#961;&#962;&#963;&#964;&#965;&#966;&#967;&#968;&#969;&#977;&#978;&#982;&#338;&#339;&#352;&#353;&#376;&#402;&#710;&#732;&#8194;&#8195;&#8201;&#8204;&#8205;&#8206;&#8207;&#8211;&#8212;&#8216;&#8217;&#8218;&#8220;&#8221;&#8222;&#8224;&#8225;&#8226;&#8230;&#8240;&#8242;&#8243;&#8249;&#8250;&#8254;&#8364;&#8482;&#8592;&#8593;&#8594;&#8595;&#8596;&#8629;&#8968;&#8969;&#8970;&#8971;&#9674;&#9824;&#9827;&#9829;&#9830;&#9989;&#10060;");var r="MZC1rF2F4C3D3A14B7iAd1Te1YZNYAc1CUKUEQOHFVANUqB2C1E7C6E1F5B4A1D3A10==";if(amazonEditor)froalaEditor=new FroalaEditor("textarea#pastedContent",{key:r,theme:"2"==settings.theme?"dark":null,language:l,height:null!==getOption(EDITORS_HEIGHT)&&isR?getOption(EDITORS_HEIGHT):isR&&0!=settings.editorHeight?settings.editorHeight:"300",fullPage:!1,placeholderText:editorPlaceholder,imagePaste:!1,wordPasteModal:!1,htmlAllowedTags:["p","strong","b","em","i","br","ul","ol","li"],htmlAllowedAttrs:[],htmlAllowComments:!1,wordPasteKeepFormatting:!1,documentReady:!1,toolbarButtons:[["newhtml","copyhtml","pastecontent","undo","redo","bold","italic","underline","formatOL","formatUL","specialCharacters","spellChecker"]],charCounterMax:2e3,autofocus:!0,attribution:!1,entities:n,events:{initialized:e,contentChanged:t,"paste.after":a,click:o,"paste.before":pasteHTMLIntoVisualEditor,"window.copy":function(e){isT&&copyHtmlToClipboardFromVisualEditorTrialMode()&&e.preventDefault()}}});else{FroalaEditor.DefineIcon("align_dropdown",{SVG_KEY:"alignLeft"}),FroalaEditor.RegisterCommand("align_dropdown",{title:lajax.t("Align options"),type:"dropdown",focus:!1,refreshAfterCallback:!1,options:{left:lajax.t("Left align"),right:lajax.t("Right align"),center:lajax.t("Center"),justify:lajax.t("Justify")},callback:function(e,t){froalaEditor.align.apply(t)}});var s=[["newhtml","aiWriter","copyhtml","pastecontent","undo","redo","paragraphFormat","fontFamily","fontSize","textColor","backgroundColor","bold","italic","underline","strikeThrough","textShadow"],["subscript","superscript","align_dropdown","formatOL","formatUL","lineHeight","outdent","indent","quote","inlineStyle","paragraphStyle","clearFormatting","formatPainter","htmltemplates"],["insertLink","insertImage","imagesManager","insertVideo","insertTable","fontAwesome","specialCharacters","emojisButton","insertHR","fullscreen","print","spellChecker","selectAll","pageStyleDefaults","help"]];1==froalaIconsMode&&(s=[["newhtml","aiWriter","copyhtml","pastecontent","undo","redo","paragraphFormat","fontFamily","fontSize","textShadow"],["textColor","backgroundColor","bold","italic","underline","strikeThrough","subscript","superscript","align_dropdown"],["formatOL","formatUL","lineHeight","outdent","indent","quote","inlineStyle","paragraphStyle","clearFormatting","formatPainter","insertLink","insertTable","htmltemplates"],["insertImage","imagesManager","insertVideo","fontAwesome","specialCharacters","emojisButton","insertHR","fullscreen","print","spellChecker","selectAll","pageStyleDefaults","help"]]);var d={moreText:{buttons:["newhtml","aiWriter","bold","italic","underline","strikeThrough","subscript","superscript","fontFamily","fontSize","textColor","backgroundColor","textShadow","inlineStyle","paragraphStyle","clearFormatting","formatPainter","htmltemplates"]},moreParagraph:{buttons:["align_dropdown","formatOL","formatUL","paragraphFormat","lineHeight","outdent","indent","quote"]},moreRich:{buttons:["insertLink","insertImage","imagesManager","insertTable","insertVideo","fontAwesome","specialCharacters","emojisButton","insertHR"],buttonsVisible:4},moreMisc:{buttons:["undo","redo","copyhtml","pastecontent","fullscreen","print","spellChecker","selectAll","pageStyleDefaults","help"]}};window.innerWidth<1e3&&(settings.compactToolbar=1);var c={"Arial, Helvetica, sans-serif":"Arial","'Arial Black', Gadget, sans-serif":"Arial Black","Calibri, sans-serif":"Calibri","Comic Sans MS, sans-serif":"Comic Sans MS","Courier New, courier":"Courier New","Georgia, serif":"Georgia",Helvetica:"Helvetica","Impact, Charcoal, sans-serif":"Impact","'Lucida Console', Monaco, monospace":"Lucida Console","'Lucida Sans Unicode', 'Lucida Grande', sans-serif":"Lucida Sans Unicode","'Palatino Linotype', 'Book Antiqua', Palatino, serif":"Palatino Linotype",Symbol:"Symbol","Tahoma,Geneva, sans-serif":"Tahoma","'Times New Roman', Times, serif":"Times New Roman","'Trebuchet MS', Helvetica, sans-serif":"Trebuchet MS","Verdana, Geneva, sans-serif":"Verdana"},p=["https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css"];if(isP||isT){if(void 0!==settings.customFontNames&&0<settings.customFontNames.trim().length)for(var m=settings.customFontNames.trim().split("#"),u=0;u<m.length;u++)m[u].trim().includes(" ")?c["'"+m[u].trim()+"'"]=m[u].trim():c[m[u].trim()]=m[u].trim();if(void 0!==settings.customFontUrls&&0<settings.customFontUrls.trim().length)for(var g=settings.customFontUrls.trim().split("#"),u=0;u<g.length;u++)p.push(g[u].trim())}void 0!==settings.customCss&&p.push(settings.customCss),$("#fontFamilySelect").empty(),$("#fontFamilySelect").append(new Option(lajax.t("Please select"),"")),$("#tableFontFamilySelect").empty(),$("#tableFontFamilySelect").append(new Option(lajax.t("Please select"),""));var h=Object.entries(c);for(u=0;u<h.length;u++){var E=new Option(h[u][1],h[u][0]);$("#fontFamilySelect").append(E);var f=new Option(h[u][1],h[u][0]);$("#tableFontFamilySelect").append(f)}var T={"Big Red":"font-size: 20px; color: red;","Small Blue":"font-size: 14px; color: blue;"},S={};if(S["Please set custom CSS styles in Settings"]=lajax.t("Please set custom CSS styles in Settings"),(isP||isT)&&null!==customCSSObject){var S={},T=customCSSObject,v=Object.keys(T);for(u=0;u<v.length;u++)S[v[u].trim()]=v[u].trim()}var b=["8","9","10","11","12","13","14","15","16","17","18","19","20","22","24","26","28","30","36","48","60","72","96"],C="px";for(void 0!==settings.fontSizeUnit&&(C=settings.fontSizeUnit),$("#fontSizeSelect").empty(),$("#fontSizeSelect").append(new Option(lajax.t("Please select"),"")),$("#tableFontSizeSelect").empty(),$("#tableFontSizeSelect").append(new Option(lajax.t("Please select"),"")),u=0;u<b.length;u++)E=new Option(b[u]+C,b[u]+C),$("#fontSizeSelect").append(E),f=new Option(b[u]+C,b[u]+C),$("#tableFontSizeSelect").append(f);froalaEditor=new FroalaEditor("textarea#pastedContent",{key:r,theme:"2"==settings.theme?"dark":null,language:l,fontFamilySelection:!0,fontSizeSelection:!0,fontSize:b,fontSizeUnit:C,paragraphFormatSelection:!0,height:null!==getOption(EDITORS_HEIGHT)&&isR?getOption(EDITORS_HEIGHT):isR&&0!=settings.editorHeight?settings.editorHeight:"300",fullPage:!0,toolbarSticky:!1,iframeStyleFiles:p,iframeStyle:"2"==settings.theme?"body{background:"+DARK_COLOR_BG+";color:"+DARK_COLOR_FONT:"body{background:"+LIGHT_COLOR_BG+";color:"+LIGHT_COLOR_FONT+';} html{margin:0px;height:auto;} body{height:auto;padding:10px;position:relative;z-index: 2;-webkit-user-select:auto;margin:0px;overflow:hidden;min-height:20px;}body:after{content:"";display:block;clear:both;}body::-moz-selection{background:#b5d6fd;color:#000;}body::selection{background:#b5d6fd;color:#000;}body, body:focus{outline: transparent solid 0px;}body a{user-select: auto;}body.fr-disabled{user-select: none;}body [contenteditable="true"]{outline: transparent solid 0px;}body{overflow-wrap: break-word;}body span[style~="color:"] a{color: inherit;}body strong{font-weight: 700;}body table{border: none; border-collapse: collapse; empty-cells: show; max-width: 100%;}body table td{min-width: 5px;}body table.fr-dashed-borders td, body table.fr-dashed-borders th{border-style: dashed;}body table.fr-alternate-rows tbody tr:nth-child(2n){background: whitesmoke;}body table td, body table th{border: 1px solid rgb(221, 221, 221);}body table td:empty, body table th:empty{height: 20px;}body table td.fr-highlighted, body table th.fr-highlighted{border: 1px double red;}body table td.fr-thick, body table th.fr-thick{border-width: 2px;}body hr{clear: both; user-select: none; break-after: page;}body .fr-file{position: relative;}body .fr-file::after{position: relative; content: "📎"; font-weight: normal;}body pre{white-space: pre-wrap; overflow-wrap: break-word; overflow: visible;}body[dir="rtl"] blockquote{border-left: none; border-right: 2px solid rgb(94, 53, 177); margin-right: 0px; padding-right: 5px; padding-left: 0px;}body[dir="rtl"] blockquote blockquote{border-color: rgb(0, 188, 212);}body[dir="rtl"] blockquote blockquote blockquote{border-color: rgb(67, 160, 71);}body blockquote{border-left: 2px solid rgb(94, 53, 177); margin-left: 0px; padding-left: 5px; color: rgb(94, 53, 177);}body blockquote blockquote{border-color: rgb(0, 188, 212); color: rgb(0, 188, 212);}body blockquote blockquote blockquote{border-color: rgb(67, 160, 71); color: rgb(67, 160, 71);}body span.fr-emoticon{font-weight: normal; font-family: "Apple Color Emoji", "Segoe UI Emoji", NotoColorEmoji, "Segoe UI Symbol", "Android Emoji", EmojiSymbols; display: inline; line-height: 0;}body span.fr-emoticon.fr-emoticon-img{font-size: inherit; height: 1em; width: 1em; min-height: 20px; min-width: 20px; display: inline-block; margin: -0.1em 0.1em 0.1em; line-height: 1; vertical-align: middle; background-repeat: no-repeat !important;}body .fr-text-gray{color: rgb(170, 170, 170) !important;}body .fr-text-bordered{border-top: 1px solid rgb(34, 34, 34); border-bottom: 1px solid rgb(34, 34, 34); padding: 10px 0px;}body .fr-text-spaced{letter-spacing: 1px;}body .fr-text-uppercase{text-transform: uppercase;}body .fr-class-highlighted{background-color: rgb(255, 255, 0);}body .fr-class-code{border-color: rgb(204, 204, 204); border-radius: 2px; background: rgb(245, 245, 245); padding: 10px; font-family: "Courier New", Courier, monospace;}body .fr-class-transparency{opacity: 0.5;}body img{position: relative; max-width: 100%;}body img.fr-dib{margin: 5px auto; display: block; float: none; vertical-align: top;}body img.fr-dib.fr-fil{margin-left: 0px; text-align: left;}body img.fr-dib.fr-fir{margin-right: 0px; text-align: right;}body img.fr-dii{display: inline-block; float: none; vertical-align: bottom; margin-left: 5px; margin-right: 5px; max-width: inherit;}body img.fr-dii.fr-fil{float: left; margin: 5px 5px 5px 0px; max-width: calc(100% - 5px);}body img.fr-dii.fr-fir{float: right; margin: 5px 0px 5px 5px; max-width: calc(100% - 5px);}body span.fr-img-caption{position: relative; max-width: 100%;}body span.fr-img-caption.fr-dib{margin: 5px auto; display: block; float: none; vertical-align: top;}body span.fr-img-caption.fr-dib.fr-fil{margin-left: 0px; text-align: left;}body span.fr-img-caption.fr-dib.fr-fir{margin-right: 0px; text-align: right;}body span.fr-img-caption.fr-dii{display: inline-block; float: none; vertical-align: bottom; margin-left: 5px; margin-right: 5px; max-width: calc(100% - 10px);}body span.fr-img-caption.fr-dii.fr-fil{float: left; margin: 5px 5px 5px 0px; max-width: calc(100% - 5px);}body span.fr-img-caption.fr-dii.fr-fir{float: right; margin: 5px 0px 5px 5px; max-width: calc(100% - 5px);}body .fr-video{text-align: center; position: relative;}body .fr-video.fr-rv{padding-bottom: 56.25%; padding-top: 30px; height: 0px; overflow: hidden;}body .fr-video.fr-rv > iframe, body .fr-video.fr-rv object, body .fr-video.fr-rv embed{top: 0px; left: 0px; width: 100%; height: 100%; position: absolute !important;}body .fr-video > *{box-sizing: content-box; max-width: 100%; border: none;}body .fr-video.fr-dvb{display: block; clear: both;}body .fr-video.fr-dvb.fr-fvl{text-align: left;}body .fr-video.fr-dvb.fr-fvr{text-align: right;}body .fr-video.fr-dvi{display: inline-block;}body .fr-video.fr-dvi.fr-fvl{float: left;}body .fr-video.fr-dvi.fr-fvr{float: right;}body a.fr-strong{font-weight: 700;}body a.fr-green{color: green;}body .fr-img-caption{text-align: center;}body .fr-img-caption .fr-img-wrap{padding: 0px; display: inline-block; margin: auto; text-align: center; width: 100%;}body .fr-img-caption .fr-img-wrap img{display: block; margin: auto; width: 100%;}body .fr-img-caption .fr-img-wrap > span{margin: auto; display: block; padding: 5px 5px 10px; font-size: 14px; font-weight: initial; box-sizing: border-box; opacity: 0.9; width: 100%; text-align: center;}body button.fr-rounded, body input.fr-rounded, body textarea.fr-rounded{border-radius: 10px; background-clip: padding-box;}body button.fr-large, body input.fr-large, body textarea.fr-large{font-size: 24px;}body img{cursor: pointer;}body table td.fr-selected-cell, body table th.fr-selected-cell{border: 1px double rgb(0, 152, 247);}body table tr{user-select: none;}body table td, body table th{user-select: text;}body .fr-no-selection table td, body .fr-no-selection table th{user-select: none;}body .fr-video{user-select: none;}body .fr-video::after{position: absolute; content: ""; z-index: 1; top: 0px; left: 0px; right: 0px; bottom: 0px; cursor: pointer; display: block; background: rgba(0, 0, 0, 0);}body .fr-video.fr-active > *{z-index: 2; position: relative;}body .fr-video > *{box-sizing: content-box; max-width: 100%; border: none;}body .fr-embedly{user-select: none; position: relative;}body .fr-embedly::after{position: absolute; content: ""; z-index: 1; top: 0px; left: 0px; right: 0px; bottom: 0px; cursor: pointer; display: block; background: rgba(0, 0, 0, 0);}body .fr-embedly > *{box-sizing: content-box; max-width: 100%; border: none;}body{text-align: inherit;}body h1, body h2, body h3{margin: 10px 0px;}body blockquote{margin: 10px 0px;}body p{margin-bottom: 10px !important;}',htmlAllowedTags:["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","blockquote","br","button","canvas","caption","cite","code","col","colgroup","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","hgroup","hr","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","menu","menuitem","meter","nav","noscript","object","ol","optgroup","option","output","p","param","pre","progress","queue","rp","rt","ruby","s","samp","script","style","section","select","small","source","span","strike","strong","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr","svg","defs","g","path"],htmlAllowedAttrs:["accept","accept-charset","accesskey","action","align","allowfullscreen","allowtransparency","alt","aria-.*","async","autocomplete","autofocus","autoplay","autosave","background","bgcolor","border","charset","cellpadding","cellspacing","checked","cite","class","color","cols","colspan","content","contenteditable","contextmenu","controls","coords","data","data-.*","datetime","default","defer","dir","dirname","disabled","download","draggable","dropzone","enctype","for","form","formaction","frameborder","headers","height","hidden","high","href","hreflang","http-equiv","icon","id","ismap","itemprop","keytype","kind","label","lang","language","list","loop","low","max","maxlength","media","method","min","mozallowfullscreen","multiple","muted","name","novalidate","open","optimum","pattern","ping","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","reversed","rows","rowspan","sandbox","scope","scoped","scrolling","seamless","selected","shape","size","sizes","span","src","srcdoc","srclang","srcset","start","step","summary","spellcheck","style","tabindex","target","title","type","translate","usemap","value","valign","webkitallowfullscreen","width","wrap","xmlns","xmlns:xlink","version","d","transform","fill","fill-opacity","fill-rule"],pasteDeniedAttrs:["id"],quickInsertButtons:["aiWriterQuickInsert","image","video","embedly","table","ul","ol","hr"],imageUploadURL:"/site/upload-image",imageCORSProxy:WTH_DOMAIN+"/proxy.php?url=",imageManagerLoadURL:"/site/load-images",imageManagerDeleteURL:"/site/delete-image",imageManagerPageSize:10,imageEditButtons:["imageReplace","imageAlign","imageRemove","|","imageLink","linkOpen","linkEdit","linkRemove","imageSize","-","imageDisplay","imageAlt","imageEditor","imageResize"],imageAllowedTypes:["jpeg","jpg","png","gif","webp","svg+xml"],placeholderText:editorPlaceholder,imageInsertButtons:isR?["imageBack","|","imageUpload","imageByURL","imageManager"]:["imageBack","|","imageUpload","imageByURL"],fontFamily:c,imageDefaultWidth:0,imageDefaultMargin:0,imageOutputSize:!(!isR||1!=settings.imageSizeInHtml),inlineStyles:T,entities:n,paragraphStyles:S,paragraphFormat:{N:"Normal",H1:"Heading 1",H2:"Heading 2",H3:"Heading 3",H4:"Heading 4",PRE:"Code",Article:"Article",Aside:"Aside",Blockquote:"Blockquote",Figure:"Figure",Figcaption:"Figcaption",Header:"Header",Footer:"Footer",Main:"Main",Nav:"Nav",Section:"Section",Summary:"Summary",Time:"Time"},imageDefaultDisplay:"inline",wordPasteModal:!(!isR||3!=settings.pasteMode),wordPasteKeepFormatting:1==settings.pasteMode||3==settings.pasteMode,linkEditButtons:["linkOpen","linkEdit","linkRemove"],videoInsertButtons:["videoBack","|","videoByURL","videoEmbed"],autofocus:!0,attribution:!1,htmlRemoveTags:[],tableEditButtons:["tableOptions","tableHeader","tableFooter","tableRemove","|","tableRows","tableColumns","-","tableCellOptions","tableCells","tableCellBackground","tableCellVerticalAlign","tableCellHorizontalAlign"],linkList:[{text:"Google",href:"https://google.com",target:"_blank",rel:"nofollow"},{displayText:"Facebook",href:"https://facebook.com",target:"_blank",rel:"nofollow"}],toolbarButtons:1==settings.compactToolbar?d:s,toolbarButtonsMD:1==settings.compactToolbar?d:s,toolbarButtonsSM:1==settings.compactToolbar?d:s,toolbarButtonsXS:1==settings.compactToolbar?d:s,events:{initialized:e,contentChanged:t,blur:function(){var e=new Date;lastBlurTime=e.getTime(),copyToClipboardFromEditor=!1},"paste.before":pasteHTMLIntoVisualEditor,"paste.after":a,"paste.beforeCleanup":function(e){froalaWordPaste=!!(e.includes("schemas-microsoft-com:office:word")||e.includes("schemas-microsoft-com:office:excel")||e.includes('<meta name=Generator content="Microsoft')||e.includes('<meta name="generator" content="LibreOffice'))},"paste.afterCleanup":function(e){if(froalaWordPaste)return fixWordHTML(e);if(0==copyToClipboardFromEditor&&detectHTMLToCleanup(e)&&0==pasteHTMLAsTextCancelled)if(3==settings.pasteMode){if(confirm(lajax.t("Would you like to cleanup and remove formatting from your pasted HTML? Click Cancel to keep formatting. You can turn off this prompt in the Paste mode section of the Settings page.")))return trackEvent("HTML cleanup OK on paste in Visual Editor","paste"),cleanupPastedHTML(e);trackEvent("HTML cleanup Cancel on paste in Visual Editor","paste")}else if(2==settings.pasteMode)return cleanupPastedHTML(e)},"image.beforePasteUpload":function(e){checkPasteLimitForGuestUsersAndShowModal()&&froalaEditor.commands.undo()},"image.beforeUpload":function(e){var t,i=this;if($("#embedImages").is(":checked")||!1===isR||!1===froalaWordPaste)return imageToResizeInEditor=i.image.get(),e.length&&((t=new FileReader).onload=function(o){imageConversion.dataURLtoFile(o.target.result).then(a=>{inputImageToResize=a,(inputImageElement=new Image).onload=function(){inputImageWidth=this.width,inputImageHeight=this.height;var e=1200,t=800;$("#embedImages").is(":checked")&&(e=800,t=600),(this.width>e||this.height>t)&&!froalaWordPaste?($("#imageSizeSlider").slider("setValue",getImageWitdthResizeFactor(this.width)),"image/jpeg"==inputImageToResize.type?($("#jpegQualityDiv").fadeIn(),$("#jpegModeDiv").fadeOut()):("image/webp"==inputImageToResize.type?$("#jpegQualityDiv").fadeIn():($("#jpegQualityDiv").fadeOut(),jpegModeFirstEvent=!1),$("#jpegModeDiv").fadeIn(),$("#jpegMode").prop("checked",!1).change()),$("#imageResizeTopInfo").show(),$("#insertOriginalImageButton").show(),$("#imageResizeModal").modal("show"),resizeInputImage()):$("#embedImages").is(":checked")||!1===isR?(t=null,1==settings.imageSizeInHtml&&(t={width:this.width,height:this.height}),i.image.insert(o.target.result,null,t,imageToResizeInEditor),contentChange()):uploadImageAjax(a,imageToResizeInEditor,inputImageWidth,inputImageHeight)},inputImageElement.src=URL.createObjectURL(a)})},t.readAsDataURL(e[0])),setTimeout(function(){froalaEditor.popups.hideAll()},1e3),!1},"image.error":function(e,t){console.log(e)},"image.resize":function(e){e.removeAttr("width")},"image.inserted":i,"image.replaced":i,click:o,keyup:function(e){e.ctrlKey&&e.shiftKey&&69==e.keyCode&&runFormatPainter(),e.ctrlKey&&e.shiftKey&&70==e.keyCode&&applyFormatPainter()},"video.inserted":function(e){e[0].className="",e[0].outerHTML=e[0].innerHTML,a()},"window.copy":function(e){isT&&copyHtmlToClipboardFromVisualEditorTrialMode()&&e.preventDefault(),copyToClipboardFromEditor=!0},"commands.after":function(e,t,a){}}})}}function uploadImageAjax(e,t,a,o){var i=new FormData;i.append("file",e),$.ajax({url:"/site/upload-image",type:"POST",data:i,processData:!1,contentType:!1,beforeSend:function(e){loading()},success:function(e){e=JSON.parse(e);null!=t?(t[0].src=e.link,1==settings.imageSizeInHtml?(t[0].width=a,t[0].height=o):(t.removeAttr("width"),t.removeAttr("height")),contentChange()):froalaEditor.image.insert(e.link,null,null,null),imageToResizeInEditor=null,loaded(),setTimeout(function(){froalaEditor.popups.hideAll()},500)},error:function(e,t,a){loaded(),showAjaxAlert(e,t,a)}})}function disableCleanupButtonTooltip(){$("#cleanupButton").removeAttr("title")}function setTemplateModified(e){isTemplateModified=e,setOption(IS_TEMPLATE_MODIFIED,isTemplateModified)}function templateModified(){setTemplateModified(!0)}function templateNotModified(){setTemplateModified(!1)}function contentChange(){var e=1e3;55<(e=!useTiny?(new Date).getTime()-lastBlurTime:e)&&(e=getVisualEditorHtml(),amazonEditor&&amazonEditorLimitCheck(e),htmlCodeEditor.setValue(e),setOption(HTML_CONTENT,htmlCodeEditor.getValue()),enableFileSaving(),e=getBodyOnly(e),isVisualHtmlModified=0<e.length)}function selectHtmlEditorElement(e,t){t&&console.log(e);var a=getAllPreviousTags(e);t&&console.log(a);for(var o={line:0,ch:0},i={line:0,ch:0},l="",n=!1,r=!1,s=a.length-1;0<=s;s--){var l=a[s].tag,r=!1,d=new RegExp("<"+l+"[^<>]*>","i");"s"===a[s].type&&(r=!0,d=new RegExp("<"+l+"[^<>]*>(.*?)</"+l+">","im")),t&&console.log(d),t&&console.log(i);var c=htmlCodeEditor.getSearchCursor(d,i);if(c.findNext(),t&&console.log(c),c.atOccurrence&&(n=!0,o=c.pos.from,i=c.pos.to,r)){var p=c.pos.match[1];for(t&&console.log(p),d=new RegExp("<"+l+"[> ]","i");d.test(p);){var m=new RegExp(".*?</"+l+">","i"),u=htmlCodeEditor.getSearchCursor(m,i);if(u.findNext(),t&&console.log(u),!u.atOccurrence)break;p=u.pos.match[0],t&&console.log(p),i=u.pos.to}}}t&&console.log(n),n&&(htmlCodeEditor.doc.setCursor(o),r||((u=htmlCodeEditor.getSearchCursor("</"+l+">",i)).findNext(),t&&console.log(u),u.atOccurrence&&(i=u.pos.to)),htmlCodeEditor.doc.setSelection(o,i))}function setAllCleanupOptions(e){$("#removeFormatting").prop("checked",e),$("#removeClasses").prop("checked",e),$("#removeSpanTags").prop("checked",e),$("#removePTags").prop("checked",e),$("#removeIds").prop("checked",e),$("#removeScripts").prop("checked",e),$("#removeImages").prop("checked",e),$("#removeLinks").prop("checked",e),$("#removeTables").prop("checked",e),$("#removeForms").prop("checked",e),$("#removeAnyEmptyTag").prop("checked",e),$("#removeTagsWithWhitespace").prop("checked",e),$("#removeAllTagAttributes").prop("checked",e),$("#removeComments").prop("checked",e),$("#removeIframes").prop("checked",e),$("#removeEmptyLines").prop("checked",e)}function setCodeEditorHeight(e){htmlCodeEditor.setSize("100%",e-50)}function pasteEventGA(e,t){var a,o,i=!1,l=!1;e&&e.clipboardData&&e.clipboardData.types&&e.clipboardData.getData&&((o=e.clipboardData.types)instanceof DOMStringList&&o.contains("text/html")||o.indexOf&&-1!==o.indexOf("text/html")?(i=!0,null!=(a=e.clipboardData.getData("text/html").match(/name=["']*generator["']*\s+content="([^<>"]+)"/i))&&2<=a.length&&trackEvent(t+" HTML Generator","paste",a[1])):o.indexOf&&-1!==o.indexOf("text/plain")?(e.clipboardData.getData("text/plain"),i=!1):o.indexOf&&-1!==o.indexOf("Files")&&(l=!0)),trackEvent(t,"paste",i?"Html paste":l?"File paste":"Text paste")}function getAllPreviousTags(e){var t=[];if(null!=e){var a=!0;for(null==(o=e.previousSibling)&&"body"!=e.parentNode.localName?(a=!1,o=e.parentNode,t.push({tag:e.localName,type:"p"})):t.push({tag:e.localName,type:"s"});null!=o;){null!=o.localName&&(a?t.push({tag:o.localName,type:"s"}):t.push({tag:o.localName,type:"p"}));var o,i=o,a=!0;if(null==(o=o.previousSibling)){if(null==i.parentNode||"body"==i.parentNode.localName)break;o=i.parentNode,a=!1}}}return t}function escapeRegExp(e){return e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")}function enableFileSaving(){$("#docSaveButton").prop("disabled",!1),$("#docSaveMenuButton").removeClass("disabled")}jQuery.fn.sizeChanged=function(e){var t=this,a=t.width(),o=t.height();return setInterval(function(){a===t.width()&&o===t.height()||"function"==typeof e&&(e({width:t.width(),height:t.height()}),a=t.width(),o=t.height())},100),t};var customJSCodeMirror=null,customJSPreprocessCodeMirror=null;function setupCustomJSEditor(){(customJSPreprocessCodeMirror=CodeMirror.fromTextArea(customJSPreprocess,{mode:"text/javascript",lineNumbers:1==settings.showLineNumbers,lineWrapping:1==settings.lineWrappig,foldGutter:1==settings.codeFolding,gutters:["CodeMirror-linenumbers","CodeMirror-foldgutter"],matchBrackets:!0,theme:1==settings.theme?"default":CODE_DARK_THEME,extraKeys:{"Ctrl-Space":"autocomplete"}})).on("change",function(e){setOption(CUSTOM_JS_PREPROCESS,customJSPreprocessCodeMirror.getValue()),templateModified()}),(customJSCodeMirror=CodeMirror.fromTextArea(customJS,{mode:"text/javascript",lineNumbers:1==settings.showLineNumbers,lineWrapping:1==settings.lineWrappig,foldGutter:1==settings.codeFolding,gutters:["CodeMirror-linenumbers","CodeMirror-foldgutter"],matchBrackets:!0,theme:1==settings.theme?"default":CODE_DARK_THEME,extraKeys:{"Ctrl-Space":"autocomplete"}})).on("change",function(e){setOption(CUSTOM_JS,customJSCodeMirror.getValue()),templateModified()})}function stripHtml(e){var t=document.createElement("DIV");return t.innerHTML=e,t.textContent||t.innerText||""}function setCleanupOptionFromLocalStorage(e){null!==getOption(e)&&("true"===getOption(e)?$("#"+e).prop("checked",!0):$("#"+e).removeAttr("checked"))}function fillInFindReplaceList(){$("#"+FIND_REPLACE_LIST).empty();for(var e=0;e<findReplaceList.length;e++){var t,a=findReplaceList[e],o="",o=0<a.replace.length?lajax.t("Replace"):lajax.t("Delete");a.isRegex&&(o+=" regexp",t="",a.gFlag&&(t+="g"),a.iFlag&&(t+="i"),a.mFlag&&(t+="m"),0<t.length&&(o+=" ("+t+")")),o+=": "+a.find,0<a.replace.length&&(o+=" => "+a.replace);o=new Option(o,e);$("#"+FIND_REPLACE_LIST).append(o)}}function storeConvertOptions(){setOption(EMBED_IMAGES,$("#embedImages").is(":checked")),setOption(FULL_PAGE_MODE,$("#fullPageMode").is(":checked")),setOption(HTML_FIXED_MODE,$("#fixedHtml").is(":checked"))}var FIND_REPLACE_LIST="findReplaceList",TAG_ATTRIBUTES_LIST="tagAttributesList",SELECTED_TEMPLATE_ID="selectedTemplateID",SELECTED_DOC_NAME="selectedDocName",EDITORS_SIZE="editorsSize",AUTO_SAVE="autoSave",CODE_EDITOR_FONT_SIZE="codeEditorFontSize",EDITORS_HEIGHT="editorsHeight",EMBED_IMAGES="embedImages",HTML_FIXED_MODE="fixedHtml",FULL_PAGE_MODE="fullPageMode",HTML_CUSTOM_MEDIA_URL="htmlCustomMediaURL",AMAZON_MODE="amazonMode",REMOVE_FORMATTING="removeFormatting",REMOVE_CLASSES="removeClasses",REMOVE_SPAN_TAGS="removeSpanTags",REMOVE_P_TAGS="removePTags",REMOVE_IDS="removeIds",REMOVE_SCRIPTS="removeScripts",REMOVE_IMAGES="removeImages",REMOVE_LINKS="removeLinks",REMOVE_TABLES="removeTables",REMOVE_FORMS="removeForms",REMOVE_ANY_EMPTY_TAG="removeAnyEmptyTag",REMOVE_TAGS_WITH_WHITESPACE="removeTagsWithWhitespace",REMOVE_ALL_TAG_ATTRIBUTES="removeAllTagAttributes",REMOVE_COMMENTS="removeComments",REMOVE_IFRAMES="removeIframes",REMOVE_EMPTY_LINES="removeEmptyLines",REMOVE_EMPTY_ATTRIBUTES="removeEmptyAttributes",REMOVE_DATA_ATTRIBUTES="removeDataAttributes",COMPRESS_HTML="compressHTML",INDENT_HTML="indentHTML",CSS_TO_KEEP="cssToKeep",CSS_TO_REMOVE="cssToRemove",CSS_CLASSES_TO_KEEP="cssClassesToKeep",CSS_CLASSES_TO_REMOVE="cssClassesToRemove",CUSTOM_JS="customJS",CUSTOM_JS_PREPROCESS="customJSPreprocess",TEST_EMAIL="testEmail",EMAIL_SUBJECT="emailSubject",SHOW_CLEANUP_COPY_CLIPBOARD_INFO="showCleanupCopyToClipboardInfo",IS_TEMPLATE_MODIFIED="isTemplateModified",IS_SHARED_DOCUMENT="isSharedDocument",IS_SHARED_DOCUMENT_LOCKED="sharedDocumentLocked",IS_DOCUMENT_OWNER="isDocumentOwner",SHARED_DOCUMENT_ALLOW_WRITTING="sharedDocumentAllowWritting",SHARED_DOCUMENT_WITH_USERS="sharedDocumentWithUsers";function getOptionsArray(){return{FORMATTING:$("#"+REMOVE_FORMATTING).is(":checked"),CLASSES:$("#"+REMOVE_CLASSES).is(":checked"),SPAN_TAGS:$("#"+REMOVE_SPAN_TAGS).is(":checked"),P_TAGS:$("#"+REMOVE_P_TAGS).is(":checked"),IDS:$("#"+REMOVE_IDS).is(":checked"),SCRIPTS:$("#"+REMOVE_SCRIPTS).is(":checked"),IMAGES:$("#"+REMOVE_IMAGES).is(":checked"),LINKS:$("#"+REMOVE_LINKS).is(":checked"),TABLES:$("#"+REMOVE_TABLES).is(":checked"),FORMS:$("#"+REMOVE_FORMS).is(":checked"),ANY_EMPTY_TAG:$("#"+REMOVE_ANY_EMPTY_TAG).is(":checked"),TAGS_WITH_WHITESPACE:$("#"+REMOVE_TAGS_WITH_WHITESPACE).is(":checked"),ALL_TAG_ATTRIBUTES:$("#"+REMOVE_ALL_TAG_ATTRIBUTES).is(":checked"),COMMENTS:$("#"+REMOVE_COMMENTS).is(":checked"),IFRAMES:$("#"+REMOVE_IFRAMES).is(":checked"),EMPTY_LINES:$("#"+REMOVE_EMPTY_LINES).is(":checked"),EMPTY_ATTRIBUTES:$("#"+REMOVE_EMPTY_ATTRIBUTES).is(":checked"),DATA_ATTRIBUTES:$("#"+REMOVE_DATA_ATTRIBUTES).is(":checked"),COMPRESS_HTML:$("#"+COMPRESS_HTML).is(":checked"),INDENT_HTML:$("#"+INDENT_HTML).is(":checked"),CSS_TO_KEEP:$("#"+CSS_TO_KEEP).val(),CSS_TO_REMOVE:$("#"+CSS_TO_REMOVE).val(),CSS_CLASSES_TO_KEEP:$("#"+CSS_CLASSES_TO_KEEP).val(),CSS_CLASSES_TO_REMOVE:$("#"+CSS_CLASSES_TO_REMOVE).val(),CUSTOM_JS:customJSCodeMirror.getValue(),CUSTOM_JS_PREPROCESS:customJSPreprocessCodeMirror.getValue(),TAG_ATTRIBUTES:JSON.stringify(tagAttributesList)}}function detectHTMLToCleanup(e){return!(!e.includes('class="')&&!e.includes('style="'))}function cleanupPastedHTML(e){return e=(e=(e=(e=removeComments(e=removeDataAttributes(e=removeClasses(e=(e=(e=cssStylesToKeep(e=(e=(e=(e=(e=(e=e.replace(/(<([a-z0-9]+)[^<>]*style="[^<>"]*)font-weight:\s*(700|bold);([^<>"]*"[^<>]*>.*?<\/\2>)/gi,"<b>$1$2$4</b>")).replace(/(<([a-z0-9]+)[^<>]*style="[^<>"]*)text-decoration:\s*underline;([^<>"]*"[^<>]*>.*?<\/\2>)/gi,"<u>$1$2$3</u>")).replace(/(<([a-z0-9]+)[^<>]*style="[^<>"]*)text-decoration:\s*line-through;([^<>"]*"[^<>]*>.*?<\/\2>)/gi,"<s>$1$2$3</s>")).replace(/(<([a-z0-9]+)[^<>]*style="[^<>"]*)font-style:\s*italic;([^<>"]*"[^<>]*>.*?<\/\2>)/gi,"<em>$1$2$3</em>")).replace(/(<([a-z0-9]+)[^<>]*style="[^<>"]*)vertical-align:\s*super;([^<>"]*"[^<>]*>.*?<\/\2>)/gi,"<sup>$1$2$3</sup>")).replace(/(<([a-z0-9]+)[^<>]*style="[^<>"]*)vertical-align:\s*sub;([^<>"]*"[^<>]*>.*?<\/\2>)/gi,"<sub>$1$2$3</sub>"),"list-style-type, text-align, color, background-color, font-size")).replace(/color:\s*#000000;/gi,"")).replace(/background-color:\s*transparent;/gi,""))))).replace(/(<[^<>]+) dir="ltr"/gi,"$1")).replace(/(<[^<>]+) lang="[^<>"]+"/gi,"$1")).replace(/(<[^<>]+) aria[a-z0-1-_]+="[^<>"]+"/gi,"$1")}function removeStyles(e){return e=(e=(e=(e=e.replace(/(<[^<>]+) style=["][^"<>]*["]/gi,"$1")).replace(/(<[^<>]+) style=['][^'<>]*[']/gi,"$1")).replace(/(<[^<>]+) style=[^'"<> ]+/gi,"$1")).replace(/<style[\s\S]*?<\/style>\s*/gim,"")}function removeClasses(e){return e=(e=(e=e.replace(/(<[^<>]+) class=["][^"<>]*["]/gi,"$1")).replace(/(<[^<>]+) class=['][^'<>]*[']/gi,"$1")).replace(/(<[^<>]+) class=[^'"<> ]+/gi,"$1")}function removeComments(e){return e.replace(/<!--[\s\S]*?-->\s*/gi,"")}function removeDataAttributes(e){return e.replace(/(<[a-z0-9]+) ([^<>]+)/gi,function(e,t,a){a=a.replace(/\s*data[a-z0-1-_]*="[^<>"]*"/gi,"");return t+(a=0<(a=0<a.trim().length?a.replace(/\s*data[a-z0-1-_]*='[^<>']*'/gi,""):a).trim().length?" "+a.trim():a)})}function cleanup(){amazonEditor?trackEvent("Cleanup HTML Amazon Editor","click"):trackEvent("Cleanup HTML","click");var isSelection=!1,html="";if((isP||isT)&&useTiny&&!1===tinymce.activeEditor.selection.isCollapsed()||!useTiny&&!1===froalaEditor.selection.isCollapsed()?(html=useTiny?tinymce.activeEditor.selection.getContent():froalaEditor.html.getSelected(),isSelection=!0):html=htmlCodeEditor.getValue(),0==html.trim().length)return showNotificationWarning(lajax.t("There is nothing to cleanup. Please enter or paste some content into Visual or HTML editor.")),!1;var noCleanupOptions=!1;!1===checkIfAnyTemplateCleanupOptionIsSet()&&(noCleanupOptions=!0,showNotificationWarning(lajax.t("You need to select some HTML cleanup options.")),showTemplateCleanupOptions(),$("#removeFormatting").prop("checked",!0),$("#removeClasses").prop("checked",!0),$("#removeDataAttributes").prop("checked",!0),$("#removeComments").prop("checked",!0),$("#indentHTML").prop("checked",!0)),loading(),$("#cleanupButton").addClass("cleanup"),$("#cleanupButton").prop("disabled",!0),$("#cleanupButton").html('<i class="fa fa-lg fa-gears"></i> '+lajax.t("Processing...")),window.onerror=function(e,t,a){return alert(lajax.t("There is an error in your custom preprocessing Javascript code. Please check your code. \nError details: {e}",{e:e})),afterCleanup(),$('#cleanupTabs a[href="#customJSTab"]').tab("show"),!1};var jsTrialSkipNotificationShown=!1,customJSPreprocess=customJSPreprocessCodeMirror.getValue();setOption(CUSTOM_JS_PREPROCESS,customJSPreprocess),0<customJSPreprocess.trim().length&&(isT?(showNotification(lajax.t("Word To HTML trial will skip custom Javascript code. Please Go PRO to run your custom Javascript."),"warning"),jsTrialSkipNotificationShown=!0):eval(customJSPreprocess)),window.onerror=function(e,t,a){return alert(lajax.t("There was an error during cleanup process.\nError details: {m}",{m:e})),afterCleanup(),!1},$("#"+REMOVE_FORMATTING).is(":checked")&&(html=removeStyles(html)),setOption(REMOVE_FORMATTING,$("#"+REMOVE_FORMATTING).is(":checked")),$("#"+REMOVE_CLASSES).is(":checked")&&(html=removeClasses(html)),setOption(REMOVE_CLASSES,$("#"+REMOVE_CLASSES).is(":checked"));var backHtml=html,tagsToRemove=[];if($("#"+REMOVE_SPAN_TAGS).is(":checked")&&tagsToRemove.push("span"),setOption(REMOVE_SPAN_TAGS,$("#"+REMOVE_SPAN_TAGS).is(":checked")),$("#"+REMOVE_P_TAGS).is(":checked")&&tagsToRemove.push("p"),setOption(REMOVE_P_TAGS,$("#"+REMOVE_P_TAGS).is(":checked")),0<tagsToRemove.length&&(html=removeElementsFromHTML(html,tagsToRemove,!0)),$("#"+REMOVE_IDS).is(":checked")&&(html=html.replace(/(<[^<>]+) id=['"][^'"<>]*['"]/gi,"$1")),setOption(REMOVE_IDS,$("#"+REMOVE_IDS).is(":checked")),$("#"+REMOVE_SCRIPTS).is(":checked")&&(html=html.replace(/<script[\s\S]*?<\/script>\s*/gi,"")),setOption(REMOVE_SCRIPTS,$("#"+REMOVE_SCRIPTS).is(":checked")),$("#"+REMOVE_IMAGES).is(":checked")&&(html=html.replace(/<img[^<>]*>\s*/gi,"")),setOption(REMOVE_IMAGES,$("#"+REMOVE_IMAGES).is(":checked")),$("#"+REMOVE_LINKS).is(":checked")&&(html=html.replace(/<a[\s\S]*?<\/a>\s*/gi,"")),setOption(REMOVE_LINKS,$("#"+REMOVE_LINKS).is(":checked")),$("#"+REMOVE_TABLES).is(":checked")&&(html=removeElementsFromHTML(html,["table"],!1)),setOption(REMOVE_TABLES,$("#"+REMOVE_TABLES).is(":checked")),$("#"+REMOVE_FORMS).is(":checked")&&(html=html.replace(/<form[\s\S]*?<\/form>\s*/gi,"")),setOption(REMOVE_FORMS,$("#"+REMOVE_FORMS).is(":checked")),$("#"+REMOVE_ANY_EMPTY_TAG).is(":checked"))for(;backHtml=html,html=html.replace(/<([a-z0-9]+)[^<>]*><\/\1>\s*/gi,""),backHtml.length!==html.length;);if(setOption(REMOVE_ANY_EMPTY_TAG,$("#"+REMOVE_ANY_EMPTY_TAG).is(":checked")),$("#"+REMOVE_TAGS_WITH_WHITESPACE).is(":checked"))for(;backHtml=html,html=html.replace(/<([a-z0-9]+)([^<>]*)>(\s|&nbsp;|&#160;)*<\/\1>\s*/gi,function(e,t,a){return"a"==t.toLowerCase()&&a.toLowerCase().includes("name=")||"td"==t.toLowerCase()?e:""}),backHtml.length!==html.length;);setOption(REMOVE_TAGS_WITH_WHITESPACE,$("#"+REMOVE_TAGS_WITH_WHITESPACE).is(":checked")),$("#"+REMOVE_ALL_TAG_ATTRIBUTES).is(":checked")?html=html.replace(/<([a-z0-9]+) [^<>]+>/gi,"<$1>"):($("#"+REMOVE_EMPTY_ATTRIBUTES).is(":checked")&&(html=html.replace(/(<[a-z0-9]+) ([^<>]+)>/gi,function(e,t,a){a=a.replace(/\s*[a-z0-1-_]+=["']\s*["']/gi,"");return t+(a=0<a.trim().length?" "+a.trim():a)+">"})),$("#"+REMOVE_DATA_ATTRIBUTES).is(":checked")&&(html=removeDataAttributes(html))),setOption(REMOVE_ALL_TAG_ATTRIBUTES,$("#"+REMOVE_ALL_TAG_ATTRIBUTES).is(":checked")),setOption(REMOVE_EMPTY_ATTRIBUTES,$("#"+REMOVE_EMPTY_ATTRIBUTES).is(":checked")),setOption(REMOVE_DATA_ATTRIBUTES,$("#"+REMOVE_DATA_ATTRIBUTES).is(":checked")),$("#"+REMOVE_COMMENTS).is(":checked")&&(html=removeComments(html)),setOption(REMOVE_COMMENTS,$("#"+REMOVE_COMMENTS).is(":checked")),$("#"+REMOVE_IFRAMES).is(":checked")&&(html=html.replace(/<iframe[\s\S]*?<\/iframe>\s*/gi,"")),setOption(REMOVE_IFRAMES,$("#"+REMOVE_IFRAMES).is(":checked")),0<$("#"+CSS_TO_KEEP).val().length&&(0<$("#"+CSS_TO_REMOVE).val().length&&alert(lajax.t("Please note that you can not use both keep and remove css styles at the same time. Please remove styles to keep or remove.")),html=cssStylesToKeep(html,$("#"+CSS_TO_KEEP).val())),setOption(CSS_TO_KEEP,$("#"+CSS_TO_KEEP).val()),0<$("#"+CSS_TO_REMOVE).val().length&&(html=cssStylesToRemove(html,$("#"+CSS_TO_REMOVE).val())),setOption(CSS_TO_REMOVE,$("#"+CSS_TO_REMOVE).val()),0<$("#"+CSS_CLASSES_TO_KEEP).val().length&&(0<$("#"+CSS_CLASSES_TO_REMOVE).val().length&&alert(lajax.t("Please note that you can not use both keep and remove css classes at the same time. Please remove classes to keep or remove.")),html=cssClassesToKeep(html,$("#"+CSS_CLASSES_TO_KEEP).val())),setOption(CSS_CLASSES_TO_KEEP,$("#"+CSS_CLASSES_TO_KEEP).val()),0<$("#"+CSS_CLASSES_TO_REMOVE).val().length&&(html=cssClassesToRemove(html,$("#"+CSS_CLASSES_TO_REMOVE).val())),setOption(CSS_CLASSES_TO_REMOVE,$("#"+CSS_CLASSES_TO_REMOVE).val()),window.onerror=function(e,t,a){return alert(lajax.t("There is an error in your find & replace entries.\nError details: {e}",{e:e})),afterCleanup(),$('#cleanupTabs a[href="#findReplaceTab"]').tab("show"),!1};for(var i=0;i<findReplaceList.length;i++){var frItem=findReplaceList[i],regexFlags="",regx,html;html=(regx=frItem.isRegex?(frItem.gFlag&&(regexFlags+="g"),frItem.iFlag&&(regexFlags+="i"),frItem.mFlag&&(regexFlags+="m"),new RegExp(frItem.find,regexFlags)):new RegExp(escapeRegExp(frItem.find),"g"),html.replace(regx,frItem.replace))}if(0<tagAttributesList.length&&(html=processTagsAndAttributes(html)),$("#"+REMOVE_EMPTY_LINES).is(":checked"))for(;backHtml=html,html=html.replace(/[\n\r]+[ \t]+[\n\r]+/gi,"\n"),html=html.replace(/[\n\r]{2,}/gi,"\n"),html=html.trim(),backHtml.length!==html.length;);setOption(REMOVE_EMPTY_LINES,$("#"+REMOVE_EMPTY_LINES).is(":checked")),window.onerror=function(e,t,a){return alert(lajax.t("There is an error in your custom Javascript code. Please check your code. \nError details: {e}",{e:e})),afterCleanup(),$('#cleanupTabs a[href="#customJSTab"]').tab("show"),!1};var customJS=customJSCodeMirror.getValue();setOption(CUSTOM_JS,customJS),0<customJS.trim().length&&(isT?!1===jsTrialSkipNotificationShown&&showNotification(lajax.t("Word To HTML trial will skip custom Javascript code. Please Go PRO to run your custom Javascript."),"warning"):eval(customJS)),window.onerror=function(e,t,a){return!1},$("#"+COMPRESS_HTML).is(":checked")?html=compressHtmlString(html):$("#"+INDENT_HTML).is(":checked")&&(html=indentHtmlString(html)),setOption(COMPRESS_HTML,$("#"+COMPRESS_HTML).is(":checked")),setOption(INDENT_HTML,$("#"+INDENT_HTML).is(":checked")),setOption(HTML_CONTENT,html),isSelection?(useTiny?tinymce.activeEditor.selection.setContent(html):froalaEditor.html.insert(html),htmlCodeEditor.setValue(getVisualEditorHtml())):(useTiny?tinymce.activeEditor.setContent(html):froalaEditor.html.set(html),htmlCodeEditor.setValue(html)),isVisualHtmlModified=!0,1==settings.copyToClipboardAfterCleanup&&0==noCleanupOptions&&(null===getOption(SHOW_CLEANUP_COPY_CLIPBOARD_INFO)&&(alert(lajax.t("To save you time when you click the Cleanup button we automatically copy the converted HTML to your clipboard ready for pasting. If you want to turn this feature off you can do so in the Settings page.")),setOption(SHOW_CLEANUP_COPY_CLIPBOARD_INFO,!0)),copyHtmlToClipboard(!1)),enableFileSaving(),ajaxSilentCall({},"/site/html-cleanup-ajax"),afterCleanup()}function cssClassesToRemove(e,t){var a=e.matchAll(/class="([^<>""]+)"/gi);if(null!==a){for(var o=Array.from(a),i=t.split(","),l=0;l<o.length;l++){for(var n=o[l][1],r=0;r<i.length;r++)n=n.replace(new RegExp("\\s*"+i[r].trim()+"\\s*","gi"),"");e=e.replace(o[l][0],'class="'+n+'"')}e=e.replace(/ class="\s*"/g,"")}return e}function cssClassesToKeep(e,t){var a=e.match(/class="([^<>""]+)"/gi);if(null!==a)for(var o=t.split(","),i=0;i<a.length;i++){for(var l=!1,n=0;n<o.length;n++)if((d=new RegExp(o[n].trim(),"i")).test(a[i])){for(var l=!0,r="",n=0;n<o.length;n++){var s=o[n].trim(),d=new RegExp('"'+s+"\\s+","gi");0<(r+=getMatchedClasses(a[i].match(d))).length&&(r+=" "),d=new RegExp("\\s+"+s+"\\s+","gi"),0<(r+=getMatchedClasses(a[i].match(d))).length&&(r+=" "),d=new RegExp("\\s+"+s+'"',"gi"),0<(r+=getMatchedClasses(a[i].match(d))).length&&(r+=" "),d=new RegExp('"'+s+'"',"gi"),r+=getMatchedClasses(a[i].match(d))}var c=' class="'+r.trim()+'"';0===r.trim().length&&(c=""),e=e.replace(new RegExp(" "+escapeRegExp(a[i]),"gi"),c);break}l||(e=e.replace(new RegExp(escapeRegExp(" "+a[i]),"gi"),""))}return e}function cssStylesToRemove(e,t){return e=cssStylesToRemoveQuoteChar(/style="([^<>""]+)"/gi,/style="([^<>""]+)"/i,e,t,'"'),e=cssStylesToRemoveQuoteChar(/style='([^<>']+)'/gi,/style='([^<>']+)'/i,e,t,"'")}function cssStylesToRemoveQuoteChar(e,t,a,o,i='"'){var l=a.match(e);if(null!==l){for(var n=o.split(","),r=0;r<l.length;r++){var s=l[r].match(t);if(null!==s){for(var d=s[1],c=0;c<n.length;c++)d=0<n[c].indexOf(":")?d.replace(new RegExp(escapeRegExp(n[c].trim())+"[; ]*","i"),""):d.replace(new RegExp(escapeRegExp(n[c].trim())+"s*:s*[^<>"+i+";]+[; ]*","i"),"");d=d.replace(new RegExp("[;]+","i"),";"),a=a.replace(l[r],"style="+i+d+i)}}a=(a=a.replace(/ style=["'][; ]*["']/gi,"")).replace(/<span>((?:(?!<span\b[^>]*>).)*?)<\/span>/gi,"$1")}return a}function cssStylesToKeep(e,t){return e=cssStylesToKeepQuoteChar(/style="([^<>""]+)"/gi,e,t,'"'),e=cssStylesToKeepQuoteChar(/style='([^<>']+)'/gi,e,t,"'")}function cssStylesToKeepQuoteChar(e,t,a,o='"'){var i=t.match(e);if(console.log(i),null!==i&&null!=a&&0<a.length){for(var l=a.split(","),n=0;n<i.length;n++){for(var r=!1,s=0;s<l.length;s++)if(i[n].includes(l[s].trim())){r=!0;break}if(r){for(var d="",s=0;s<l.length;s++){var c=new RegExp(escapeRegExp(l[s].trim())+"s*:s*[^<>"+o+";]+[;]*","i");0<l[s].indexOf(":")&&(c=new RegExp(escapeRegExp(l[s].trim())+"[;]*","i"));c=i[n].match(c);null!==c&&(d+=c[0])}var p=" style="+o+d.trim()+o;0===d.trim().length&&(p=""),t=t.replace(new RegExp(" "+escapeRegExp(i[n]),"gi"),p)}else t=t.replace(new RegExp(escapeRegExp(" "+i[n]),"gi"),"")}t=t.replace(/<span>((?:(?!<span\b[^>]*>).)*?)<\/span>/gi,"$1")}return t}function getMatchedClasses(e){var t="";if(null!==e)for(var a=0;a<e.length;a++)0<t.length&&(t+=" "),t+=e[a].replace('"',"").trim();return t}function removeElementsFromHTML(e,t,a){var o=hasHtmlBody(e),i=e;o&&(i=getBodyOnly(e)),$("body").append('<div id="tagAttributesTempDiv" style="display: none">'+i+"</div>");for(var l=0;l<t.length;l++)a?$("#tagAttributesTempDiv "+t[l]).contents().unwrap():$("#tagAttributesTempDiv "+t[l]).remove();var n=$("#tagAttributesTempDiv").html();return void 0!==n?(i=n,e=o?e.replace(/(<body[^<>]*>)[\s\S]*<\/body>/,"$1"+i+"</body>"):i):alert(lajax.t("There is an issue in your Manage tags and attributes section and your HTML was not processed.")),$("#tagAttributesTempDiv").remove(),e}function processTagsAndAttributes(e){var t=hasHtmlBody(e),a=e;t&&(a=getBodyOnly(e)),$("body").append('<div id="tagAttributesTempDiv" style="display: none">'+a+"</div>");for(var o=0;o<tagAttributesList.length;o++){var i,l,n=tagAttributesList[o];"aa"===n.action?n.enum?(i=parseInt(n.enumFrom),$("#tagAttributesTempDiv "+n.tag).each(function(e){$(this).attr(n.attr,n.value+i),i++})):"class"===n.attr?$("#tagAttributesTempDiv "+n.tag).addClass(n.value):"style"===n.attr&&0<n.value.indexOf(":")&&n.value.indexOf(";")<0?(l=n.value.split(":"),$("#tagAttributesTempDiv "+n.tag).css(l[0],l[1])):$("#tagAttributesTempDiv "+n.tag).attr(n.attr,n.value):"ra"===n.action?"class"===n.attr&&0<n.value.length?$("#tagAttributesTempDiv "+n.tag).removeClass(n.value).filter('[class=""]').removeAttr("class"):$("#tagAttributesTempDiv "+n.tag).removeAttr(n.attr):"ae"===n.action?$("#tagAttributesTempDiv "+n.tag).append(n.value):"pe"===n.action?$("#tagAttributesTempDiv "+n.tag).prepend(n.value):"re"===n.action?$("#tagAttributesTempDiv "+n.tag).remove():"we"===n.action?$("#tagAttributesTempDiv "+n.tag).wrap(n.value):"wie"===n.action?$("#tagAttributesTempDiv "+n.tag).wrapInner(n.value):"ue"===n.action?$("#tagAttributesTempDiv "+n.tag).replaceWith(function(){return $(this).contents()}):"repe"===n.action&&$("#tagAttributesTempDiv "+n.tag).replaceWith(n.value)}var r=$("#tagAttributesTempDiv").html();return void 0!==r?(a=r,e=t?e.replace(/(<body[^<>]*>)[\s\S]*<\/body>/,"$1"+a+"</body>"):a):alert(lajax.t("There is an issue in your Manage tags and attributes section and your HTML was not processed.")),$("#tagAttributesTempDiv").remove(),e}function afterCleanup(){setTimeout(function(){$("#cleanupButton").html('<i class="fa fa-lg fa-gears"></i> '+lajax.t("Cleanup my HTML")),$("#cleanupButton").removeClass("cleanup"),$("#cleanupButton").prop("disabled",!1),loaded()},500)}function addFindReplace(){var e,t;0===$("#find").val().length?(alert(lajax.t("Please enter a find string")),$("#find").focus()):isP||isT||0===findReplaceList.length?(t="",t=0<$("#replace").val().length?lajax.t("Replace"):lajax.t("Delete"),$("#useRegex").is(":checked")&&(t+=" regexp",e="",$("#gFlag").is(":checked")&&(e+="g"),$("#iFlag").is(":checked")&&(e+="i"),$("#mFlag").is(":checked")&&(e+="m"),0<e.length&&(t+=" ("+e+")")),t+=": "+$("#find").val(),0<$("#replace").val().length&&(t+=" => "+$("#replace").val()),e=new Option(t,findReplaceList.length),0<=(t=$("#"+FIND_REPLACE_LIST).prop("selectedIndex"))?($("#"+FIND_REPLACE_LIST+" option").eq(t).after(e),findReplaceList.splice(t+1,0,{find:$("#find").val(),replace:$("#replace").val(),isRegex:$("#useRegex").is(":checked"),gFlag:$("#gFlag").is(":checked"),iFlag:$("#iFlag").is(":checked"),mFlag:$("#mFlag").is(":checked")})):($("#"+FIND_REPLACE_LIST).append(e),findReplaceList.push({find:$("#find").val(),replace:$("#replace").val(),isRegex:$("#useRegex").is(":checked"),gFlag:$("#gFlag").is(":checked"),iFlag:$("#iFlag").is(":checked"),mFlag:$("#mFlag").is(":checked")})),setOption(FIND_REPLACE_LIST,JSON.stringify(findReplaceList)),templateModified(),$("#btnUpdateFindReplace").fadeOut()):registerPopup()}var frSelIdx=-1;function editFindReplace(){var e=$("#"+FIND_REPLACE_LIST).prop("selectedIndex");0<=e?(e=findReplaceList[frSelIdx=e],$("#find").val(e.find),$("#replace").val(e.replace),$("#useRegex").prop("checked",e.isRegex),e.isRegex?($("#regexFlags").fadeIn(),setFlagUI(e.gFlag,"g"),setFlagUI(e.iFlag,"i"),setFlagUI(e.mFlag,"m")):$("#regexFlags").fadeOut(),$("#btnUpdateFindReplace").fadeIn()):alert(lajax.t("Please select find/replace item first"))}function setFlagUI(e,t){e?($("#"+t+"FlagLabel").addClass("active"),$("#"+t+"Flag").prop("checked",!0)):($("#"+t+"FlagLabel").removeClass("active"),$("#"+t+"Flag").prop("checked",!1))}function updateFindReplace(){var e;0<=frSelIdx&&((e=findReplaceList[frSelIdx]).find=$("#find").val(),e.replace=$("#replace").val(),e.isRegex=$("#useRegex").is(":checked"),e.gFlag=$("#gFlag").is(":checked"),e.iFlag=$("#iFlag").is(":checked"),e.mFlag=$("#mFlag").is(":checked"),fillInFindReplaceList(),setOption(FIND_REPLACE_LIST,JSON.stringify(findReplaceList)),templateModified(),$("#btnUpdateFindReplace").fadeOut(),frSelIdx=-1)}function deleteFindReplace(){var e=!1,a=[];$("#"+FIND_REPLACE_LIST+" :selected").each(function(e,t){t=parseInt($(t).val());a.push(t)}),a.reverse();for(var t=0;t<a.length;t++)findReplaceList.splice(a[t],1),e=!0;e&&(templateModified(),setOption(FIND_REPLACE_LIST,JSON.stringify(findReplaceList)),fillInFindReplaceList(),$("#btnUpdateFindReplace").fadeOut())}function upFindReplace(){if(1<findReplaceList.length){var e=!1,a=[];$("#"+FIND_REPLACE_LIST+" :selected").each(function(e,t){t=parseInt($(t).val());0<t&&a.push(t)});for(var t=0;t<a.length;t++){var o=findReplaceList[a[t]-1];findReplaceList[a[t]-1]=findReplaceList[a[t]],findReplaceList[a[t]]=o,e=!0}e&&(setOption(FIND_REPLACE_LIST,JSON.stringify(findReplaceList)),fillInFindReplaceList(),templateModified(),1===a.length&&$("#"+FIND_REPLACE_LIST).prop("selectedIndex",a[0]-1),$("#btnUpdateFindReplace").fadeOut())}}function downFindReplace(){if(1<findReplaceList.length){var e=!1,a=[];$("#"+FIND_REPLACE_LIST+" :selected").each(function(e,t){t=parseInt($(t).val());t<findReplaceList.length-1&&a.push(t)}),a.reverse();for(var t=0;t<a.length;t++){var o=findReplaceList[a[t]+1];findReplaceList[a[t]+1]=findReplaceList[a[t]],findReplaceList[a[t]]=o,e=!0}e&&(setOption(FIND_REPLACE_LIST,JSON.stringify(findReplaceList)),fillInFindReplaceList(),templateModified(),1===a.length&&$("#"+FIND_REPLACE_LIST).prop("selectedIndex",a[0]+1),$("#btnUpdateFindReplace").fadeOut())}}function addTagAttribute(){var e,t,a=$("#tagAction option:selected").val();0===a.length?(alert(lajax.t("Please select an action")),$("#tagAction").focus()):"aa"!==a&&"ra"!==a||0!==$("#tagAttribute").val().length?isP||isT||0===tagAttributesList.length?(t=getTagActionInfo(a,$("#tag").val(),$("#tagAttribute").val(),$("#attributeValue").val(),$("#tagAttributeEnumerate").is(":checked"),$("#startEnumerateFrom").val()),e=new Option(t,tagAttributesList.length),0<=(t=$("#"+TAG_ATTRIBUTES_LIST).prop("selectedIndex"))?($("#"+TAG_ATTRIBUTES_LIST+" option").eq(t).after(e),tagAttributesList.splice(t+1,0,{action:a,tag:$("#tag").val(),attr:$("#tagAttribute").val(),value:$("#attributeValue").val(),enum:$("#tagAttributeEnumerate").is(":checked"),enumFrom:$("#startEnumerateFrom").val()})):($("#"+TAG_ATTRIBUTES_LIST).append(e),tagAttributesList.push({action:a,tag:$("#tag").val(),attr:$("#tagAttribute").val(),value:$("#attributeValue").val(),enum:$("#tagAttributeEnumerate").is(":checked"),enumFrom:$("#startEnumerateFrom").val()})),setOption(TAG_ATTRIBUTES_LIST,JSON.stringify(tagAttributesList)),templateModified(),$("#btnUpdateTagAttribute").fadeOut()):registerPopup():(alert(lajax.t("Please enter an attribute")),$("#tagAttribute").focus())}function getTagActionInfo(e,t,a,o,i,l){var n="";"aa"===e?n=lajax.t("Add attribute"):"ra"===e?n=lajax.t("Remove attribute"):"ae"===e?n=lajax.t("Append elements"):"pe"===e?n=lajax.t("Prepend elements"):"re"===e?n=lajax.t("Remove elements"):"we"===e?n=lajax.t("Wrap elements"):"wie"===e?n=lajax.t("Wrap inner elements"):"ue"===e?n=lajax.t("Unwrap elements"):"repe"===e&&(n=lajax.t("Replace elements"));var r=n+": ";return"aa"===e?(n="",r+=t+" => "+a+' ="'+o+'"'+(n=i?" ("+lajax.t("enumerate from")+" "+l+")":n)):"ra"===e?0<o.length?r+=t+" => "+a+" = "+o:r+=t+" => "+a:r+="re"===e||"ue"===e?t:t+" => "+o,r}var taSelIdx=-1;function editTagAttribute(){var e=$("#"+TAG_ATTRIBUTES_LIST).prop("selectedIndex");0<=e?(e=tagAttributesList[taSelIdx=e],$("#tagAction").val(e.action).change(),$("#tag").val(e.tag),$("#tagAttribute").val(e.attr),$("#attributeValue").val(e.value),$("#tagAttributeEnumerate").prop("checked",e.enum).change(),e.enum&&$("#startEnumerateFrom").val(e.enumFrom),$("#btnUpdateTagAttribute").fadeIn()):alert(lajax.t("Please select tag attribute item first"))}function updateTagAttribute(){var e;0<=taSelIdx&&((e=tagAttributesList[taSelIdx]).action=$("#tagAction").val(),e.tag=$("#tag").val(),e.attr=$("#tagAttribute").val(),e.value=$("#attributeValue").val(),e.enum=$("#tagAttributeEnumerate").is(":checked"),e.enumFrom=$("#startEnumerateFrom").val(),$("#tagAction").val(""),$("#tag").val(""),$("#tagAttribute").val(""),$("#attributeValue").val(""),$("#tagAttributeEnumerate").prop("checked",!1).change(),fillInTagAttributesList(),setOption(TAG_ATTRIBUTES_LIST,JSON.stringify(tagAttributesList)),templateModified(),$("#btnUpdateTagAttribute").fadeOut(),taSelIdx=-1)}function deleteTagAttribute(){var e=!1,a=[];$("#"+TAG_ATTRIBUTES_LIST+" :selected").each(function(e,t){t=parseInt($(t).val());a.push(t)}),a.reverse();for(var t=0;t<a.length;t++)tagAttributesList.splice(a[t],1),e=!0;e&&(setOption(TAG_ATTRIBUTES_LIST,JSON.stringify(tagAttributesList)),templateModified(),fillInTagAttributesList(),$("#btnUpdateTagAttribute").fadeOut())}function upTagAttribute(){if(1<tagAttributesList.length){var e=!1,a=[];$("#"+TAG_ATTRIBUTES_LIST+" :selected").each(function(e,t){t=parseInt($(t).val());0<t&&a.push(t)});for(var t=0;t<a.length;t++){var o=tagAttributesList[a[t]-1];tagAttributesList[a[t]-1]=tagAttributesList[a[t]],tagAttributesList[a[t]]=o,e=!0}e&&(setOption(TAG_ATTRIBUTES_LIST,JSON.stringify(tagAttributesList)),fillInTagAttributesList(),templateModified(),1===a.length&&$("#"+TAG_ATTRIBUTES_LIST).prop("selectedIndex",a[0]-1),$("#btnUpdateTagAttribute").fadeOut())}}function downTagAttribute(){if(1<tagAttributesList.length){var e=!1,a=[];$("#"+TAG_ATTRIBUTES_LIST+" :selected").each(function(e,t){t=parseInt($(t).val());t<tagAttributesList.length-1&&a.push(t)}),a.reverse();for(var t=0;t<a.length;t++){var o=tagAttributesList[a[t]+1];tagAttributesList[a[t]+1]=tagAttributesList[a[t]],tagAttributesList[a[t]]=o,e=!0}e&&(setOption(TAG_ATTRIBUTES_LIST,JSON.stringify(tagAttributesList)),fillInTagAttributesList(),templateModified(),1===a.length&&$("#"+TAG_ATTRIBUTES_LIST).prop("selectedIndex",a[0]+1),$("#btnUpdateTagAttribute").fadeOut())}}function fillInTagAttributesList(){$("#"+TAG_ATTRIBUTES_LIST).empty();for(var e=0;e<tagAttributesList.length;e++){var t=tagAttributesList[e],t=getTagActionInfo(t.action,t.tag,t.attr,t.value,t.enum,t.enumFrom),t=new Option(t,e);$("#"+TAG_ATTRIBUTES_LIST).append(t)}}function deleteDocConfirmation(){if(0<$("#document").val()){if(!isDocumentOwner)return alert(lajax.t("Only owner can delete the shared document."));var e=getVisualEditorHtml();new RegExp('="'+WTH_MEDIA_URL).test(e)?$("#deleteDocModal").modal("show"):confirmModal(lajax.t("Are you sure to delete this document?"),function(){deleteSavedDoc(!1)})}else showSelectDocNotification()}function showSelectDocNotification(){showNotificationWarning(lajax.t("Please select a document first")),blinkElement(".select2-container--krajee")}function deleteSavedDoc(e){isDocAjax=!0,ajaxCall({documentID:$("#document").val(),withMedia:e},"/site/delete-doc-ajax",function(e){var t=$("#document").find("option[value='"+$("#document").val()+"']");t.length&&t.remove(),$("#document").trigger("change"),isDocAjax=!1,newDocument()}),e?trackEvent("Delete saved HTML with media","click"):trackEvent("Delete saved HTML only","click")}function checkVisualEditorModifiedAndSaveDoc(){isVisualHtmlModified&&confirmModal(lajax.t("You have unsaved content in Visual Editor. Do you want to save it first?"),function(){saveDoc()})}function duplicateDocModal(){0<$("#document").val()?(checkVisualEditorModifiedAndSaveDoc(),$("#docName").val(docName+" copy"),$("#docSaveModalButton").off("click"),$("#docSaveModalButton").click(duplicateDoc),$("#docNameModal").modal("show"),setTimeout(function(){$("#docName").focus()},500)):showSelectDocNotification()}function duplicateDoc(){var a=$("#docName").val().trim();0===a.length?(alert(lajax.t("Please enter a document name")),$("#docName").focus()):(isDocAjax=!0,ajaxCall({documentName:a,documentID:$("#document").val()},"/site/duplicate-doc-ajax",function(e){$("#docNameModal").modal("hide"),resetSharedDoc();var t=new Option(e.documentName,e.documentID,!0,!0);$("#document").append(t),$("#document").trigger("change"),docID=e.documentID,docName=a,setOption(SELECTED_DOC_ID,docID),setOption(SELECTED_DOC_NAME,docName),isDocAjax=!1}))}function renameDocModal(){if(0<$("#document").val()){if(!isDocumentOwner)return alert(lajax.t("Only owner can rename the shared document."));$("#docName").val(docName),$("#docSaveModalButton").off("click"),$("#docSaveModalButton").click(renameDoc),$("#docNameModal").modal("show"),setTimeout(function(){$("#docName").focus()},500)}else showSelectDocNotification()}function renameDoc(){var a=$("#docName").val().trim();0===a.length?(alert(lajax.t("Please enter a document name")),$("#docName").focus()):ajaxCall({documentName:a,documentID:$("#document").val()},"/site/rename-doc-ajax",function(e){$("#docNameModal").modal("hide"),docName=a,setOption(SELECTED_DOC_NAME,docName);var t=$("#document").find("option[value='"+docID+"']");t.length&&(e=new Option(e.documentName,docID,!0,!0),t.replaceWith(e)),$("#document").trigger("change")})}function saveAsNewDocModal(){$("#docName").val(""),$("#docSaveModalButton").off("click"),$("#docSaveModalButton").click(saveAsNewDoc),$("#docNameModal").modal("show"),setTimeout(function(){$("#docName").focus()},500)}function saveAsNewDoc(){var a=$("#docName").val().trim();0<a.length?(isDocAjax=!0,$("#docSaveButton").prop("disabled",!0),ajaxCall({documentName:a,content:getHtmlCodeFromEditor()},"/site/save-new-doc-ajax",function(e){$("#docNameModal").modal("hide"),resetSharedDoc();var t=new Option(e.documentName,e.documentID,!0,!0);$("#document").append(t),docID=e.documentID,docName=a,setOption(SELECTED_DOC_ID,docID),setOption(SELECTED_DOC_NAME,docName),isVisualHtmlModified=isDocAjax=!1})):(alert(lajax.t("Please enter a document name")),$("#docName").focus())}function saveDoc(e){if(0<$("#document").val()){if(isSharedDocument&&!1===allowSharedDocumentWrite&&!1===isDocumentOwner)return alert(lajax.t("Owner of this shared document did not allow changes to be saved. You can save it as your own document.")),!1;if(isSharedDocument&&isSharedDocumentLocked)return alert(lajax.t("Document is currently being edited. Please wait until other user ends editing it.")),!1;isDocAjax=!0;var t=getHtmlCodeFromEditor();return setOption(HTML_CONTENT,t),useTiny&&(tinymce.activeEditor.isNotDirty=!0),$("#docSaveButton").prop("disabled",!0),isVisualHtmlModified=!1,ajaxSilentCall({documentID:$("#document").val(),content:t},"/site/save-doc-ajax",function(){isDocAjax=!1,void 0!==e&&e()}),!0}return saveAsNewDocModal(),!1}var isDocAjax=!1,sharedDocLockIntervalID=null;function loadDocument(){0<$("#document").val()&&(resetSharedDoc(),isDocAjax=!0,docID=$("#document").val(),ajaxCallFailure({documentID:docID},"/site/load-doc-ajax",function(e){setOption(SELECTED_DOC_ID,docID),docName=e.documentName,setOption(SELECTED_DOC_NAME,docName),updateVisualEditor=!0,setOption(HTML_CONTENT,e.html),visualEditorSlowHTMLUpdate=!1,hasHtmlBody(e.html)&&!0!==$("#fullPageMode").prop("checked")?$("#fullPageMode").prop("checked",!0):hasHtmlBody(e.html)||!0!==$("#fullPageMode").prop("checked")||$("#fullPageMode").prop("checked",!1),htmlCodeEditor.setValue(e.html),$("#docSaveButton").prop("disabled",!0),$("#docSaveMenuButton").removeClass("disabled"),isVisualHtmlModified=isDocAjax=updateVisualEditor=!1,isDocumentOwner=e.isDocumentOwner,setOption(IS_DOCUMENT_OWNER,isDocumentOwner),setDocumentSharingOptions(e.isSharedDocument,e.allowWritting,e.sharedWithUsers),e.isSharedDocument&&null!=e.lockedByUserName?(setSharedDocLockInfo(e.lockedByUserName,e.lockedByUserEmail),isSharedDocumentLocked=!0,setOption(IS_SHARED_DOCUMENT_LOCKED,isSharedDocumentLocked),sharedDocLockIntervalID=setInterval(sharedDocLockCheck,3e4),$("#cleanupButton").prop("disabled",!0),htmlCodeEditor.setOption("readOnly","nocursor"),useTiny?tinymce.activeEditor.setMode("readonly"):froalaEditor.edit.off()):e.isSharedDocument&&(window.removeEventListener("beforeunload",sharedDocUnlockCall),window.addEventListener("beforeunload",sharedDocUnlockCall))},function(e){alert(e.ret),setVisualEditorHtml("")}))}function loadDocumentByID(e){ajaxCall({documentID:e},"/site/load-any-doc-ajax",function(e){setOption(HTML_CONTENT,e.html),visualEditorSlowHTMLUpdate=!1,hasHtmlBody(e.html)&&!0!==$("#fullPageMode").prop("checked")?$("#fullPageMode").prop("checked",!0):hasHtmlBody(e.html)||!0!==$("#fullPageMode").prop("checked")||$("#fullPageMode").prop("checked",!1),htmlCodeEditor.setValue(e.html),$("#docSaveButton").prop("disabled",!0),$("#docSaveMenuButton").removeClass("disabled"),isVisualHtmlModified=isDocAjax=updateVisualEditor=!1})}function setSharedDocLockInfo(e,t){$("#sharedDocUserInfo").html('<i class="fa fa-exclamation-circle"></i> '+lajax.t('Currently edited by <a href="mailto:{email}">{userName}</a>',{email:t,userName:e}))}function sharedDocUnlockCall(){isSharedDocument&&null!==docID&&0==isSharedDocumentLocked&&ajaxCall({documentID:docID},"/site/unlock-shared-doc-ajax")}function sharedDocLockCheck(){isSharedDocument&&null!==docID&&ajaxCall({documentID:docID},"/site/check-doc-lock-ajax",function(e){void 0!==e.docNotFound?(clearInterval(sharedDocLockIntervalID),docID=null,isSharedDocument=!1,newDocument()):0==e.isLocked?(clearInterval(sharedDocLockIntervalID),loadDocument()):null!==e.lockedByUserName&&setSharedDocLockInfo(e.lockedByUserName,e.lockedByUserEmail)},!0)}function setDocumentSharingOptions(e,t,a){isSharedDocument=e,setOption(IS_SHARED_DOCUMENT,isSharedDocument),allowSharedDocumentWrite=isSharedDocument&&t?!0:!1,setOption(SHARED_DOCUMENT_ALLOW_WRITTING,allowSharedDocumentWrite),setOption(SHARED_DOCUMENT_WITH_USERS,JSON.stringify(a)),clearAllDocumentsSharedUsers(),null!==a&&$.each(a,function(e,t){$("#documentTeamUser"+t.uID).prop("checked",!0).change(),1==t.allowWrite?$("#allowDocumentWriteUser"+t.uID).prop("checked",!0):$("#allowDocumentWriteUser"+t.uID).prop("checked",!1)})}function previewDoc(e){var t=getHtmlCodeFromEditor();0<t.length?ajaxCall({content:t,responsive:e},"/site/preview-content-ajax",function(e){window.open(e.url,"_blank").focus()}):showNotificationWarning(lajax.t("Please enter some content into Visual Editor or select a document to preview first"))}function trialCopyInfo(){$("#trialModal").modal("show")}function downloadHtml(){downloadDocumentByType("html")}function downloadHtmlWithMedia(){downloadDocumentByType("html-with-media")}function downloadHtmlWithMediaCustomPath(){$("#inputNameModal").modal("hide"),setOption(HTML_CUSTOM_MEDIA_URL,$("#inputName").val()),downloadDocumentByType("html-with-media","url="+$("#inputName").val())}function downloadDocx(){downloadDocumentByType("docx")}function getChromeVersion(){var e=navigator.userAgent.match(/Chrom(e|ium)\/([0-9]+)\./);return!!e&&parseInt(e[2],10)}function downloadPdf(){downloadDocumentByType("pdf")}function downloadEpub(){downloadDocumentByType("epub")}function downloadDocumentByType(e,t){var a;0<$("#document").val()?(docID=$("#document").val(),isVisualHtmlModified?(isDocAjax=!0,a=getHtmlCodeFromEditor(),setOption(HTML_CONTENT,a),useTiny&&(tinymce.activeEditor.isNotDirty=!0),$("#docSaveButton").prop("disabled",!0),isVisualHtmlModified=!0,ajaxCall({documentID:$("#document").val(),content:a},"/site/save-doc-ajax",function(){isDocAjax=!1,downloadDocAjaxCall(docID,e,t)})):downloadDocAjaxCall(docID,e,t)):0<(a=getHtmlCodeFromEditor()).length?downloadUnsavedDocAjaxCall(a,e,t):showNotificationWarning(lajax.t("Please enter some content into Visual Editor or select a saved document"))}function downloadUnsavedDocAjaxCall(e,a,o){ajaxCall({content:e},"/site/download-unsaved-doc-ajax",function(e){var t="/site/download-unsaved-"+a;void 0!==o&&0<o.length&&(t+="?"+encodeURI(o)),window.location.href=t}),trackEvent("Download unsaved HTML as "+a+(isP?" PRO":""),"download")}function downloadDocAjaxCall(e,t,a){ajaxCall({documentID:e},"/site/download-doc-ajax",function(e){e="/site/download-"+t+"?docID="+e.docID;void 0!==a&&0<a.length&&(e+="&"+encodeURI(a)),window.location.href=e}),trackEvent("Download HTML as "+t+(isP?" PRO":""),"download")}function deleteTemplate(){if(0<$("#template").val()){if(isSharedTemplate)return alert(lajax.t("Only owner can delete shared template."));confirmModal(lajax.t('Are you sure to delete "{t}" template?',{t:templateName}),function(){var e=$("#template").val();ajaxCall({templateID:e},"/site/delete-template-ajax",function(e){$("#templateWrapper").html(e.html),setOption(SELECTED_TEMPLATE_ID,0)})})}else showSelectTempateNotification()}function showSelectTempateNotification(){showNotificationWarning(lajax.t("Please select a template first")),blinkElement("#template")}function reloadTemplate(){0<$("#template").val()?confirmModal(lajax.t("Are you sure to reload template? It will cancel any changes you may have done to current cleanup options."),function(){loadTemplateAjaxCall($("#template").val())}):showSelectTempateNotification()}function duplicateTemplateModal(){0<$("#template").val()?($("#templateName").val(templateName+" "+lajax.t("copy")),$("#templateSaveModalButton").off("click"),$("#templateSaveModalButton").click(duplicateTemplate),isBusinessUser&&$("#shareWithTeamLabel").fadeOut(),$("#templateNameModal").modal("show"),setTimeout(function(){$("#templateName").focus()},500)):showSelectTempateNotification()}function duplicateTemplate(){var e,t=$("#templateName").val().trim();0===t.length?(alert(lajax.t("Please enter a template name")),$("#templateName").focus()):(e=$("#template").val(),ajaxCall({templateName:t,templateID:e},"/site/duplicate-template-ajax",function(e){templateName=t,$("#templateNameModal").modal("hide"),$("#templateWrapper").html(e.html),$("#template").val(e.templateID),isSharedTemplate=!1,templateNotModified()}))}function renameTemplateModal(){0<$("#template").val()?isSharedTemplate?alert(lajax.t("Only template owner can rename it")):($("#templateName").val(templateName),$("#templateSaveModalButton").off("click"),$("#templateSaveModalButton").click(renameTemplate),isBusinessUser&&$("#shareWithTeamLabel").fadeOut(),$("#templateNameModal").modal("show"),setTimeout(function(){$("#templateName").focus()},500)):showSelectTempateNotification()}function renameTemplate(){var t,a=$("#templateName").val().trim();0===a.length?(alert(lajax.t("Please enter a template name")),$("#templateName").focus()):(t=$("#template").val(),ajaxCall({templateName:a,templateID:t},"/site/rename-template-ajax",function(e){templateName=a,$("#templateNameModal").modal("hide"),$("#templateWrapper").html(e.html),$("#template").val(t)}))}function saveAsNewTemplateModal(){$("#templateName").val(""),$("#templateSaveModalButton").off("click"),$("#templateSaveModalButton").click(saveAsNewTemplate),isBusinessUser&&$("#shareWithTeamLabel").fadeIn(),$("#templateNameModal").modal("show"),setTimeout(function(){$("#templateName").focus()},500)}function saveTemplate(){0<$("#template").val()?!isSharedTemplate||allowSharedTemplateWrite?saveTemplateByID($("#template").val()):alert(lajax.t("You are not allowed to save this shared template.")):saveAsNewTemplateModal()}function saveTemplateByID(e,t){ajaxCall({templateID:e,options:JSON.stringify(getOptionsArray()),findReplace:JSON.stringify(findReplaceList)},"/site/save-template-ajax",function(){blinkElement("#template"),void 0!==t&&t()}),templateNotModified()}function saveAsNewTemplate(){var t,a=$("#templateName").val().trim();0===a.length?(alert(lajax.t("Please enter a template name")),$("#templateName").focus()):(isSharedTemplate=!1,t=!(!isBusinessUser||!$("#shareWithTeam").is(":checked")),ajaxCall({templateName:a,options:JSON.stringify(getOptionsArray()),findReplace:JSON.stringify(findReplaceList),share:t},"/site/save-new-template-ajax",function(e){templateName=a,$("#templateNameModal").modal("hide"),$("#templateWrapper").html(e.html),$("#template").val(e.templateID),setOption(SELECTED_TEMPLATE_ID,e.templateID),(t?checkAllTemplateSharedUsers:clearAllTemplateSharedUsers)(),templateNotModified()}))}var isSharedTemplate=!1,allowSharedTemplateWrite=!1,isTemplateModified=!1;function checkExistingTemplateChangesAndSave(t,e){1==isTemplateModified?!isSharedTemplate||allowSharedTemplateWrite?confirmModal(lajax.t("Your template changes have not been saved. Click OK to save or Cancel to lose your changes."),function(){var e=getOption(SELECTED_TEMPLATE_ID);null!==e&&0<e?saveTemplateByID(e,function(){t?newTemplateNoValidationForChanges():loadTemplateAjaxCall($("#template").val())}):($("#template").val(0),setOption(SELECTED_TEMPLATE_ID,0),templateNotModified(),templateName="",saveAsNewTemplateModal())},function(){templateNotModified(),e()}):newTemplateNoValidationForChanges():e()}function loadTemplate(){0<$("#template").val()&&checkExistingTemplateChangesAndSave(!1,function(){loadTemplateAjaxCall($("#template").val())})}function loadTemplateAjaxCall(a){ajaxCall({templateID:a},"/site/load-template-ajax",function(e){templateName=e.name,setCleanupOptions(e.options),setOption(SELECTED_TEMPLATE_ID,a),findReplaceList=[];for(var t=0;t<e.findReplaceItems.length;t++)findReplaceList.push({find:e.findReplaceItems[t].find,replace:e.findReplaceItems[t].replace,isRegex:e.findReplaceItems[t].isRegex,gFlag:e.findReplaceItems[t].gFlag,iFlag:e.findReplaceItems[t].iFlag,mFlag:e.findReplaceItems[t].mFlag});setOption(FIND_REPLACE_LIST,JSON.stringify(findReplaceList)),fillInFindReplaceList(),templateNotModified(),isSharedTemplate=e.sharedTemplate,allowSharedTemplateWrite=!1,isSharedTemplate&&e.allowWritting&&(allowSharedTemplateWrite=!0),clearAllTemplateSharedUsers(),null!==e.sharedWithUsers&&$.each(e.sharedWithUsers,function(e,t){$("#templateTeamUser"+t.uID).prop("checked",!0).change(),1==t.allowWrite?$("#allowWriteUser"+t.uID).prop("checked",!0):$("#allowWriteUser"+t.uID).prop("checked",!1)})})}function checkIfAnyTemplateCleanupOptionIsSet(){var e=!1,t=getOptionsArray();return t.FORMATTING&&(e=!0),t.CLASSES&&(e=!0),t.SPAN_TAGS&&(e=!0),t.P_TAGS&&(e=!0),t.IDS&&(e=!0),t.SCRIPTS&&(e=!0),t.IMAGES&&(e=!0),t.LINKS&&(e=!0),t.TABLES&&(e=!0),t.FORMS&&(e=!0),t.ANY_EMPTY_TAG&&(e=!0),t.TAGS_WITH_WHITESPACE&&(e=!0),t.ALL_TAG_ATTRIBUTES&&(e=!0),t.COMMENTS&&(e=!0),t.IFRAMES&&(e=!0),t.EMPTY_LINES&&(e=!0),t.EMPTY_ATTRIBUTES&&(e=!0),t.DATA_ATTRIBUTES&&(e=!0),t.COMPRESS_HTML&&(e=!0),t.INDENT_HTML&&(e=!0),""!=t.CSS_CLASSES_TO_KEEP.trim()&&(e=!0),""!=t.CSS_CLASSES_TO_REMOVE.trim()&&(e=!0),""!=t.CSS_TO_KEEP.trim()&&(e=!0),""!=t.CSS_TO_REMOVE.trim()&&(e=!0),""!=t.CUSTOM_JS.trim()&&(e=!0),""!=t.CUSTOM_JS_PREPROCESS.trim()&&(e=!0),0<findReplaceList.length&&(e=!0),e=0<tagAttributesList.length?!0:e}function newTemplate(){checkExistingTemplateChangesAndSave(!0,function(){newTemplateNoValidationForChanges()})}function newTemplateNoValidationForChanges(){resetTemplateOptions(),$("#template").val(0),setOption(SELECTED_TEMPLATE_ID,0),templateNotModified(),templateName="",clearAllTemplateSharedUsers()}function resetTemplateOptions(){$("#find").val(""),$("#replace").val(""),$("#useRegex").prop("checked",!1),$("#regexFlags").fadeOut(),$("#btnUpdateFindReplace").fadeOut();setCleanupOptions({FORMATTING:!1,CLASSES:!1,SPAN_TAGS:!1,P_TAGS:!1,IDS:!1,SCRIPTS:!1,IMAGES:!1,LINKS:!1,TABLES:!1,FORMS:!1,ANY_EMPTY_TAG:!1,TAGS_WITH_WHITESPACE:!1,ALL_TAG_ATTRIBUTES:!1,COMMENTS:!1,IFRAMES:!1,EMPTY_LINES:!1,CSS_TO_KEEP:"",CSS_TO_REMOVE:"",CUSTOM_JS:"",CUSTOM_JS_PREPROCESS:""}),findReplaceList=[],fillInFindReplaceList(),setOption(FIND_REPLACE_LIST,JSON.stringify(findReplaceList)),tagAttributesList=[],fillInTagAttributesList(),setOption(TAG_ATTRIBUTES_LIST,JSON.stringify(tagAttributesList)),isTemplateModified=!1}function clearAllTemplateSharedUsers(){$.each($("#shareTemplateModal .templateTeamUser"),function(){$(this).prop("checked",!1).change()})}function checkAllTemplateSharedUsers(){$.each($("#shareTemplateModal .templateTeamUser"),function(){$(this).prop("checked",!0).change()})}function shareTemplateModal(){isBusinessUser?0<$("#template").val()?!1===isSharedTemplate?($("#shareTemplateName").html(templateName),$("#shareTemplateModalButton").off("click"),$("#shareTemplateModalButton").click(shareTemplate),$("#shareTemplateModal").modal("show")):showNotificationWarning(lajax.t("You can only share your own templates")):showNotificationWarning(lajax.t("Please select a template first")):(trackEvent("Share template (trial/personal)","click"),showNotificationWarning(lajax.t("This feature is only available for users on our Business Plan")))}function shareTemplate(){var e=[],t=[];$.each($("#shareTemplateModal .templateTeamUser"),function(){$(this).is(":checked")&&(e.push($(this).attr("data-uid")),$("#allowWriteUser"+$(this).attr("data-uid")).is(":checked")&&t.push($(this).attr("data-uid")))}),ajaxCall({templateID:$("#template").val(),shareUsers:e,allowWriteUsers:t},"/site/share-template-ajax",function(){}),$("#shareTemplateModal").modal("hide")}function clearAllDocumentsSharedUsers(){$.each($("#shareDocumentModal .documentTeamUser"),function(){$(this).prop("checked",!1).change()}),$.each($("#shareDocumentModal .documentOverwrite"),function(){$(this).prop("checked",!1).change()})}function checkAllDocumentsSharedUsers(){$.each($("#shareDocumentModal .documentTeamUser"),function(){$(this).prop("checked",!0).change()})}var isSharedDocument=!1,isDocumentOwner=!0,allowSharedDocumentWrite=!1,isSharedDocumentLocked=!1;function shareDocumentModal(){isBusinessUser?0<$("#document").val()?(docID=$("#document").val(),isDocumentOwner?($("#shareDocumentName").html(docName),$("#shareDocumentModalButton").off("click"),$("#shareDocumentModalButton").click(shareDocument),$("#shareDocumentModal").modal("show"),trackEvent("Share document modal shown","click")):showNotificationWarning(lajax.t("You can only share your own documents"))):showSelectDocNotification():(trackEvent("Share document (trial/personal)","click"),showNotificationWarning(lajax.t("This feature is only available for users on our Business Plan")))}function shareDocument(){var e=[],t=[];$.each($("#shareDocumentModal .documentTeamUser"),function(){$(this).is(":checked")&&(e.push($(this).attr("data-uid")),$("#allowDocumentWriteUser"+$(this).attr("data-uid")).is(":checked")&&t.push($(this).attr("data-uid")))}),ajaxCall({documentID:$("#document").val(),shareUsers:e,allowWriteUsers:t},"/site/share-document-ajax",function(e){window.removeEventListener("beforeunload",sharedDocUnlockCall),null!==e.sharedWithUsers&&(isSharedDocument=!0,setOption(SHARED_DOCUMENT_WITH_USERS,JSON.stringify(e.sharedWithUsers)),isSharedDocument&&window.addEventListener("beforeunload",sharedDocUnlockCall))}),$("#shareDocumentModal").modal("hide")}function setCleanupOptions(e){if(setCleanupOption(REMOVE_FORMATTING,e.FORMATTING),setCleanupOption(REMOVE_CLASSES,e.CLASSES),setCleanupOption(REMOVE_SPAN_TAGS,e.SPAN_TAGS),setCleanupOption(REMOVE_P_TAGS,e.P_TAGS),setCleanupOption(REMOVE_IDS,e.IDS),setCleanupOption(REMOVE_SCRIPTS,e.SCRIPTS),setCleanupOption(REMOVE_IMAGES,e.IMAGES),setCleanupOption(REMOVE_LINKS,e.LINKS),setCleanupOption(REMOVE_TABLES,e.TABLES),setCleanupOption(REMOVE_FORMS,e.FORMS),setCleanupOption(REMOVE_ANY_EMPTY_TAG,e.ANY_EMPTY_TAG),setCleanupOption(REMOVE_TAGS_WITH_WHITESPACE,e.TAGS_WITH_WHITESPACE),setCleanupOption(REMOVE_ALL_TAG_ATTRIBUTES,e.ALL_TAG_ATTRIBUTES),setCleanupOption(REMOVE_COMMENTS,e.COMMENTS),setCleanupOption(REMOVE_IFRAMES,e.IFRAMES),setCleanupOption(REMOVE_EMPTY_LINES,e.EMPTY_LINES),setCleanupOption(REMOVE_EMPTY_ATTRIBUTES,e.EMPTY_ATTRIBUTES,!1),setCleanupOption(REMOVE_DATA_ATTRIBUTES,e.DATA_ATTRIBUTES,!1),setCleanupOption(COMPRESS_HTML,e.COMPRESS_HTML,!1),setCleanupOption(INDENT_HTML,e.INDENT_HTML,!1),setCleanupOptionString(CSS_TO_KEEP,e.CSS_TO_KEEP,""),setCleanupOptionString(CSS_TO_REMOVE,e.CSS_TO_REMOVE,""),setCleanupOptionString(CSS_CLASSES_TO_KEEP,e.CSS_CLASSES_TO_KEEP,""),setCleanupOptionString(CSS_CLASSES_TO_REMOVE,e.CSS_CLASSES_TO_REMOVE,""),void 0!==e.CUSTOM_JS_PREPROCESS?customJSPreprocessCodeMirror.setValue(e.CUSTOM_JS_PREPROCESS):customJSPreprocessCodeMirror.setValue(""),void 0!==e.CUSTOM_JS?customJSCodeMirror.setValue(e.CUSTOM_JS):customJSCodeMirror.setValue(""),tagAttributesList=[],void 0!==e.TAG_ATTRIBUTES)for(var t=JSON.parse(e.TAG_ATTRIBUTES),a=0;a<t.length;a++)tagAttributesList.push({action:t[a].action,tag:t[a].tag,attr:t[a].attr,value:t[a].value,enum:t[a].enum,enumFrom:t[a].enumFrom});setOption(TAG_ATTRIBUTES_LIST,JSON.stringify(tagAttributesList)),fillInTagAttributesList()}function setCleanupOption(e,t,a){void 0!==t?(setOption(e,t),(!0===t?$("#"+e).prop("checked",!0):$("#"+e).prop("checked",!1)).change()):void 0!==a&&(!0===a||!1===a?$("#"+e).prop("checked",a):$("#"+e).val(a)).change()}function setCleanupOptionString(e,t,a){void 0!==t?(setOption(e,t),$("#"+e).val(t).change()):void 0!==a&&(setOption(e,a),$("#"+e).val(a).change())}function registerPage(){window.location="/site/register"}function paymentPage(){window.location="/site/payment"}var editorSize=3;function leftEditorBigger(){1<editorSize&&changeEditorsSize(--editorSize)}function rightEditorBigger(){editorSize<5&&changeEditorsSize(++editorSize)}function changeEditorsSize(e){setOption(EDITORS_SIZE,e),$("#visualEditor").removeClass("col-lg-8 col-lg-7 col-lg-6 col-lg-5 col-lg-4"),$("#code").removeClass("col-lg-8 col-lg-7 col-lg-6 col-lg-5 col-lg-4"),1===e?($("#visualEditor").addClass("col-lg-4"),$("#code").addClass("col-lg-8")):2===e?($("#visualEditor").addClass("col-lg-5"),$("#code").addClass("col-lg-7")):3===e?($("#visualEditor").addClass("col-lg-6"),$("#code").addClass("col-lg-6")):4===e?($("#visualEditor").addClass("col-lg-7"),$("#code").addClass("col-lg-5")):5===e&&($("#visualEditor").addClass("col-lg-8"),$("#code").addClass("col-lg-4"))}function changeConvertedDocAutoSave(){var e=!1;!0===$("#autosaveConverterDoc").prop("checked")&&(e=!0),ajaxCall({autosave:e},"/site/set-auto-save-converted-doc-ajax",function(){})}function autosaveDoc(){if(0<$("#document").val()&&isVisualHtmlModified&&!1===isDocAjax)return isSharedDocument&&!1===allowSharedDocumentWrite?(console.log("shared doc auto save not allowed"),!1):isSharedDocument&&isSharedDocumentLocked?(console.log("shared doc auto save not done - document locked"),!1):(saveDoc(),void console.log("autosave"))}var codeEditorFontSize=14;function codeEditorFontSmaller(){11<codeEditorFontSize&&setCodeEditorForSize(--codeEditorFontSize)}function setCodeEditorForSize(e){$(".CodeMirror").css("font-size",e+"px"),setOption(CODE_EDITOR_FONT_SIZE,e),htmlCodeEditor.refresh()}function codeEditorFontBigger(){codeEditorFontSize<25&&setCodeEditorForSize(++codeEditorFontSize)}function indentHtml(){var e=htmlCodeEditor.getValue();updateVisualEditor=!0,htmlCodeEditor.setValue(indentHtmlString(e)),updateVisualEditor=!1}function indentHtmlString(e){return html_beautify(e,{preserve_newlines:!1,newline_between_rules:!0})}function compressHtml(){var e=compressHtmlString(e=htmlCodeEditor.getValue());updateVisualEditor=!0,htmlCodeEditor.setValue(e),updateVisualEditor=!1}function compressHtmlString(e){return e=(e=(e=(e=(e=(e=(e=(e=(e=e.replace(/ <([a-z0-9/]+)/gi,"&spc;<$1")).replace(/<([a-z0-9/]+)([^<>]*)> /gi,"<$1$2>&spc;")).replace(/\t<([a-z0-9/]+)/gi,"&tab;<$1")).replace(/<([a-z0-9/]+)([^<>]*)>\t/gi,"<$1$2>&tab;")).replace(/\s*(<[^<>]+>)\s*/gim,"$1")).replace(/\s+(&spc;|&tab;)(<[^<>]+>)/gim,"$1$2")).replace(/(<[^<>]+>)(&spc;|&tab;)\s+/gim,"$1$2")).replace(/&tab;/gi,"\t")).replace(/&spc;/gi," ")}function findHtml(){trackEvent("Code editor find","click"),htmlCodeEditor.execCommand("find")}function findAndReplaceHtml(){trackEvent("Code editor find and replace","click"),htmlCodeEditor.execCommand("replace")}function addToFind(){showTemplateCleanupOptions(),$('#cleanupTabs a[href="#findReplaceTab"]').tab("show"),htmlCodeEditor.somethingSelected()?$("#find").val(htmlCodeEditor.getDoc().getSelection()):null!==htmlToFindReplace?$("#find").val(htmlToFindReplace):alert(lajax.t("Please select some text or set cursor in a HTML tag to find whole tag with inner content")),trackEvent("Add to template find","click")}function addToDelete(){showTemplateCleanupOptions(),$('#cleanupTabs a[href="#findReplaceTab"]').tab("show");var e=null;htmlCodeEditor.somethingSelected()?e=htmlCodeEditor.getDoc().getSelection():null!==htmlToFindReplace?e=htmlToFindReplace:alert(lajax.t("Please select some text or set cursor in a HTML tag to delete whole tag with inner content")),null!==e&&(findReplaceList.push({find:e,replace:"",isRegex:!1,gFlag:$("#gFlag").is(":checked"),iFlag:$("#iFlag").is(":checked"),mFlag:$("#mFlag").is(":checked")}),fillInFindReplaceList(),setOption(FIND_REPLACE_LIST,JSON.stringify(findReplaceList))),trackEvent("Add to template find and delete","click")}var UNSAVED_HTML_MESSAGE=lajax.t("You have unsaved content in Visual Editor. Do you want to save it first?");function processFile(e){if(isR&&isVisualHtmlModified&&0<getHtmlCodeFromEditor().length)return confirmModal(UNSAVED_HTML_MESSAGE,function(){if(!1===saveDoc(processFile))return $("#doc").val(""),!1},function(){isVisualHtmlModified=!1,processFile(e)}),!1;if(newDocument(),null==e&&""===$("#fileForm input[type=file]").val())return alert(lajax.t("Please select a document to convert")),!1;var t=new FormData;if(t.append("embedImages",$("#embedImages").is(":checked")),t.append("fullPageMode",$("#fullPageMode").is(":checked")),t.append("fixedHtml",$("#fixedHtml").is(":checked")),t.append("autoSave",$("#autosaveConverterDoc").is(":checked")),null==e)for(var a=$("#fileForm input[type=file]")[0].files,o=0;o<a.length;o++)t.append("file",a[o]);else t.append("file",e);return loading(),$("#convertButton").prop("disabled",!0),$.ajax({type:"POST",url:"/site/convert",cache:!1,processData:!1,contentType:!1,data:t,dataType:"json"}).done(function(e){!1===e.error?(setOption(HTML_CONTENT,e.ret),setFullPageOptionIfHtmlHasBodyTag(e.ret),setVisualEditorHtml(e.ret),$("#convertedFileButtons").fadeIn(),$("#convertedFileName").text(e.name),$("#previewFile").prop("href",e.url),$("#downloadFile").prop("href",e.zip),!0===$("#autosaveConverterDoc").prop("checked")&&void 0!==e.name?($("#deleteFile").fadeOut(),contentChange(),$("#docName").val(e.name),setTimeout(function(){saveAsNewDoc()},250)):$("#deleteFile").fadeIn()):alert(e.ret)}).always(function(){$("#doc").val(""),$("#convertButton").prop("disabled",!1),loaded()}).fail(showError),!1}function deleteConvertedFile(){return loading(),$("#deleteFile").prop("disabled",!0),$.ajax({type:"POST",url:"/site/delete-converted-file",cache:!1,processData:!1,contentType:!1,dataType:"json"}).done(function(e){console.log(e),!1===e.error?$("#convertedFileButtons").fadeOut():alert(e.ret)}).always(function(){loaded()}).fail(showError),!1}function trialEndPopup(){return alert(lajax.t("Trial period has ended. Please Go PRO.")),!1}function customJSTab(){$('#cleanupTabs a[data-toggle="tab"]').on("shown.bs.tab",function(e){customJSPreprocessCodeMirror.refresh(),customJSCodeMirror.refresh()}),isP||isT||(customJSPreprocessCodeMirror.setOption("readOnly",!0),customJSCodeMirror.setOption("readOnly",!0),registerPopup())}function fullPageModeChange(){updateVisualEditor=!1,htmlCodeEditor.setValue(getVisualEditorHtml()),enableFileSaving()}function getBodyOnly(e){var t=e.match(/<body[^>]*>([\s\S]*?)<\/body>/i);return null!==t&&2===t.length?t[1].trim():e}function getHtmlCodeFromEditor(){return htmlCodeEditor.getValue()}function getVisualEditorHtml(){if(useTiny){var e=tinymce.activeEditor.getContent();return!0===$("#fullPageMode").prop("checked")?e:getBodyOnly(e)}e="";return void 0!==froalaEditor.html?indentHtmlString(e=(e=(e=(e=!0===$("#fullPageMode").prop("checked")?froalaEditor.html.get():getBodyOnly(froalaEditor.html.get())).replace('<body aria-disabled="false"',"<body")).replace(/\s*id="isPasted"/g,"")).replace(/<(img|video)[^<>]+>/gi,function(e){var t=e.replace('data-fr-image-pasted="true"',""),a='""',e=t.match(/style=("[^<>"]*")/i);return null!==e&&(a=e[1]),t.includes("fr-dib")?(a=addOrReplaceStyle(a,"display","block"),a=t.includes("fr-fil")?addOrReplaceStyle(a,"margin","0 auto 0 0"):t.includes("fr-fir")?addOrReplaceStyle(a,"margin","0 0 0 auto"):addOrReplaceStyle(a,"margin","0 auto")):t.includes("fr-fil")?a=addOrReplaceStyle(a,"float","left"):t.includes("fr-fir")&&(a=addOrReplaceStyle(a,"float","right")),t=(t='""'!=a?null!==e?t.replace(/(style=)("[^<>"]*")/gi,"$1"+a):t.replace(/(<img[^<>]*)/gi,"$1 style="+a+" "):t).replace(/ class="([^<>"]+)"/gi,function(e,t){t=t.replace(/\s*fr-[^<>" ]+\s*/gi,"");return 0==t.trim().length?"":' class="'+t+'"'})})):e}function setVisualEditorHtml(e,t=!0){""==e.trim()&&(e=html5Head),useTiny?(tinymce.activeEditor.setContent(e),t&&tinymce.activeEditor.fire("change")):(froalaEditor.html.set(e),t&&froalaEditor.events.trigger("contentChanged"))}function updateCssStylesFields(){$("#removeFormatting").is(":checked")?($("#cssToKeep").attr("disabled",!0),$("#cssToKeep").attr("placeholder","CSS styles to keep - to enable this feature please untick styles cleanup option"),$("#cssToRemove").attr("disabled",!0),$("#cssToRemove").attr("placeholder","CSS styles to remove - to enable this feature please untick styles cleanup option")):($("#cssToKeep").removeAttr("disabled"),$("#cssToKeep").attr("placeholder","CSS styles to keep (separate with a comma)"),$("#cssToRemove").removeAttr("disabled"),$("#cssToRemove").attr("placeholder","CSS styles to remove (separate with a comma)"))}function checkCssStyles(){0<$("#cssToKeep").val().length?$("#cssToRemove").attr("disabled",!0):$("#cssToRemove").removeAttr("disabled"),0<$("#cssToRemove").val().length?$("#cssToKeep").attr("disabled",!0):$("#cssToKeep").removeAttr("disabled")}function updateCssClassFields(){$("#removeClasses").is(":checked")?($("#cssClassesToKeep").attr("disabled",!0),$("#cssClassesToKeep").attr("placeholder",lajax.t("CSS classes to keep - to enable this feature please untick classes cleanup option")),$("#cssClassesToRemove").attr("disabled",!0),$("#cssClassesToRemove").attr("placeholder",lajax.t("CSS classes to remove - to enable this feature please untick classes cleanup option"))):($("#cssClassesToKeep").removeAttr("disabled"),$("#cssClassesToKeep").attr("placeholder",lajax.t("CSS classes to keep (separate with a comma)")),$("#cssClassesToRemove").removeAttr("disabled"),$("#cssClassesToRemove").attr("placeholder",lajax.t("CSS classes to remove (separate with a comma)")))}function checkCssClasses(){0<$("#cssClassesToKeep").val().length?$("#cssClassesToRemove").attr("disabled",!0):$("#cssClassesToRemove").removeAttr("disabled"),0<$("#cssClassesToRemove").val().length?$("#cssClassesToKeep").attr("disabled",!0):$("#cssClassesToKeep").removeAttr("disabled")}function switchHtmlEditorTheme(){$("#htmlEditorTheme").is(":checked")?(trackEvent("Switch Html Editor Dark theme","click"),window.location="/site/dark-theme"):(trackEvent("Switch Html Editor Default theme","click"),window.location="/site/light-theme")}function copyHtmlToClipboard(e){isT&&void 0===e&&trialCopyInfo();e="";onlyShowVisualEditorMode?(e=getVisualEditorHtml(),(useTiny&&!1===tinymce.activeEditor.selection.isCollapsed()||!useTiny&&!1===froalaEditor.selection.isCollapsed())&&(e=useTiny?tinymce.activeEditor.selection.getContent():froalaEditor.html.getSelected())):e=htmlCodeEditor.somethingSelected()?htmlCodeEditor.getSelection():htmlCodeEditor.getValue(),copyContentToClipboard(e=isT?getTrialHTML(e,!0):e)}function copyContentToClipboard(e){var t;void 0!==navigator.clipboard?navigator.clipboard.writeText(e).then(function(){},function(){alert(lajax.t("Copy to clipboard failed"))}):(t=$("<textarea>"),$("body").append(t),t.val(e).select(),document.execCommand("copy"),t.remove(),window.scrollTo(0,0)),htmlCodeEditor.focus()}function copyHtmlToClipboardFromVisualEditorTrialMode(){var e="",t=getVisualEditorHtml();if(t.length<500)return!1;var a=0,e=useTiny&&!1===tinymce.activeEditor.selection.isCollapsed()||!useTiny&&!1===froalaEditor.selection.isCollapsed()?(a=(e=useTiny?tinymce.activeEditor.selection.getContent():froalaEditor.html.getSelected()).length,getTrialHTML(e,!1)):(a=t.length,getTrialHTML(t,!0)),o=0;return.1<(o=0<t.length?a/t.length:o)&&(copyContentToClipboard(e),trialCopyInfo(),!0)}function sendTestEmailModal(){0<htmlCodeEditor.getValue().length?($("#sendEmailModalButton").off("click"),$("#sendEmailModalButton").click(sendTestEmail),$("#sendEmailModal").modal("show"),$("#sendToEmail").focus()):showNotificationWarning(lajax.t("Please enter some content into Visual Editor or select a saved document"))}function sendTestEmail(){var e;validateEmail($("#sendToEmail").val())?($("#sendEmailModal").modal("hide"),setOption(TEST_EMAIL,$("#sendToEmail").val()),setOption(EMAIL_SUBJECT,$("#emailSubject").val()),e=htmlCodeEditor.getValue(),isT&&(e=getTrialHTML(e,!0)),ajaxCall({toEmail:$("#sendToEmail").val(),subject:$("#emailSubject").val(),html:e},"/site/send-test-email-ajax",function(){trackEvent("Test email sent","email")})):(alert(lajax.t("Please enter valid email address...")),$("#sendToEmail").focus())}function showCustomImagesUrlModal(){var e=htmlCodeEditor.getValue();new RegExp('<img [^<>]*src="'+WTH_MEDIA_URL).test(e)?(null!==getOption(HTML_CUSTOM_MEDIA_URL)&&$("#inputName").val(getOption(HTML_CUSTOM_MEDIA_URL)),showInputModal(lajax.t("Custom Images URL (optional)"),lajax.t("Optionally enter custom images URL"),lajax.t("Optionally enter absolute or relative URL that will be added to all images in HTML.<br/>For example enter /wp-content/uploads/ and all images will have url like<br/>/wp-content/uploads/image.jpg <a href='https://wordtohtml.net/content/knowledge-base/convert-word-document-with-images-to-html-and-post-it-on-a-cms-like-wordpress/' target='_blank'>(more info...)</a>"),downloadHtmlWithMediaCustomPath)):downloadHtmlWithMedia()}function switchFroalaToolbarMode(){null!=froalaEditor&&(1==settings.compactToolbar?(settings.compactToolbar=0,trackEvent("Switch toolbar full","click")):(settings.compactToolbar=1,trackEvent("Switch toolbar compact","click")),isR&&ajaxCall({toolbarMode:settings.compactToolbar},"/site/set-toolbar-mode-ajax"),froalaEditor.destroy(),setupFroalaEditor())}function previewHtmlTemplate(e){null!=e&&0<e.length&&($("#templatePreview").attr("src","/templates/"+e+"?"+Math.random()),$("#htmlTemplateOKButton").prop("disabled",!1))}function setFullPageOptionIfHtmlHasBodyTag(e){(null!==e.match(/<body[^<>]*>/i)?$("#fullPageMode").prop("checked",!0):$("#fullPageMode").prop("checked",!1)).change()}function useTemplateInEditor(){$.get("/templates/"+$("#htmlTemplateList").val()+"?"+Math.random(),function(e){$("#htmlTemplatesModal").modal("hide"),docID=null,$("#document").val(0),setFullPageOptionIfHtmlHasBodyTag(e),updateVisualEditor=!1,froalaEditor.html.set(e),htmlCodeEditor.setValue(e),trackEvent("HTM Template Selected","click",$("#htmlTemplateList").val())})}function amazonEditorMode(){amazonEditor=!0===$("#amazonEditorMode").prop("checked")?(trackEvent("Amazon Editor ON","click"),!0):(trackEvent("Amazon Editor OFF","click"),!1),setOption(AMAZON_MODE,amazonEditor),useTiny?window.location.reload():(froalaEditor.destroy(),setupFroalaEditor(),(amazonEditor?hideAmazonModeAdvacedSections:showAmazonModeAdvancedSetions)())}var cleanupShown=!1;function showOrHideTemplateCleanupOptions(){!1===(cleanupShown=1==settings.showCleanupOptions?!0:cleanupShown)?showTemplateCleanupOptions():($("#cleanupTabs").fadeOut(),cleanupShown=!1,settings.showCleanupOptions=0,$("#templateOptionsButton").removeClass("btn-success"),$("#templateOptionsButton").addClass("btn-default"),trackEvent("Cleanup Options Hidden","click")),isR&&ajaxCall({visible:cleanupShown},"/site/set-cleanup-options-visibility-ajax")}function showTemplateCleanupOptions(){$("#cleanupTabs").fadeIn(),cleanupShown=!0,settings.showCleanupOptions=1,$("#templateOptionsButton").removeClass("btn-default"),$("#templateOptionsButton").addClass("btn-success"),trackEvent("Cleanup Options Shown","click")}function showAmazonModeAdvancedSetions(){640<=window.outerWidth&&$("#editorToolbarModeOption").fadeIn(),$("#docConvertOptions").fadeIn(),$("#cleanupButton").fadeIn(),$("#templateOptionsButton").fadeIn(),$("#cleanupTabs").fadeIn(500,function(){$("#cleanupTabs a[href='#findReplaceTab']").tab("show")}),$("#amazonAdvancedOptions").fadeOut(),$("#uploadDocColumn").removeClass("col-lg-12"),$("#fullPageMode").prop("checked",!1),$("#errorVisualEditor").fadeOut(),trackEvent("Show Amazon Advanced Cleanup Options","click")}function hideAmazonModeAdvacedSections(){$("#editorToolbarModeOption").fadeOut(),$("#docConvertOptions").fadeOut(),$("#cleanupButton").fadeOut(),$("#templateOptionsButton").fadeOut(),$("#cleanupTabs").fadeOut(),$("#amazonAdvancedOptions").fadeIn(),$("#uploadDocColumn").addClass("col-lg-12"),$("#errorVisualEditor").fadeIn()}function setPageStyleDefaultsAndShowModal(){var e,t,a=froalaEditor.html.get().match(/<body [^<>]*style=("[^<>"]*")/i);null!==a&&(null!==(a=(t=a[1]).match(/background-color\s*:\s*([^<>;"]+)[;"]/i))&&(-1!==(e=-1!==(e=a[1]).indexOf("rgb")?parseColor(e).hex:e).indexOf("#")&&$("#bgColorPicker").val(e),$("#bgColor").val(e)),null!==(a=t.match(/[";\s]color\s*:\s*([^<>;"]+)[;"]/i))&&(-1!==(e=-1!==(e=a[1]).indexOf("rgb")?parseColor(e).hex:e).indexOf("#")&&$("#fontColorPicker").val(e),$("#fontColor").val(e)),null!==(e=t.match(/font-family\s*:\s*([^<>;"]+)[;"]/i))&&($("#fontFamily").val(e[1]),$("#fontFamilySelect").val(e[1])),null!==(e=t.match(/font-size\s*:\s*([^<>;"]+)[;"]/i))&&($("#fontSize").val(e[1]),$("#fontSizeSelect").val(e[1])),null!==(e=t.match(/padding\s*:\s*([^<>;"]+)[;"]/i))&&$("#pagePadding").val(e[1]),null!==(e=t.match(/margin\s*:\s*([^<>;"]+)[;"]/i))&&$("#pageMargin").val(e[1]),null!==(t=t.match(/width\s*:\s*([^<>;"]+)[;"]/i))&&$("#pageWidth").val(t[1])),$("#pageDefaultsModal").modal("show")}function parseColor(e){var t=[];return e.replace(/[\d+\.]+/g,function(e){t.push(parseFloat(e))}),{hex:"#"+t.slice(0,3).map(toHex).join(""),opacity:4==t.length?t[3]:1}}function toHex(e){e=e.toString(16);return 1==e.length?"0"+e:e}function setPageStyleDefaultsInHtml(){var e,t,a;useTiny||($("#fullPageMode").prop("checked",!0).change(),a='""',a=addOrReplaceStyle(a=null!==(t=(e=froalaEditor.html.get()).match(/<body [^<>]*style=("[^<>"]*")/i))?t[1]:a,"background-color",$("#bgColor").val()),a=addOrReplaceStyle(a,"color",$("#fontColor").val()),a=addOrReplaceStyle(a,"font-family",$("#fontFamily").val()),a=addOrReplaceStyle(a,"font-size",$("#fontSize").val()),a=addOrReplaceStyle(a,"padding",$("#pagePadding").val()),a=addOrReplaceStyle(a,"margin",$("#pageMargin").val()),a=addOrReplaceStyle(a,"width",$("#pageWidth").val()),setVisualEditorHtml(e=null!==t?e.replace(/(<body [^<>]*style=)("[^<>"]*")/gi,"$1"+a):e.replace(/<body[^<>]*>/gi,"<body style="+a+">")),$("#pageDefaultsModal").modal("hide"))}function addOrReplaceStyle(e,t,a){return e=0<a.length?null!==e.match(new RegExp('["; ]'+t,"i"))?e.replace(new RegExp('(["; ]'+t+'s*:s*)[^<>:;"]+([;"])'),"$1"+a+"$2"):e.replace(/"([^<>]*)"/gi,'"'+t+": "+a+'; $1"'):e.replace(new RegExp('(["; ])'+t+'s*:s*[^<>:;"]+([;"])'),"$1$2")}function tableOptionsModal(){var e,t,a=getFroalaClickedTableElement();null!=a?(""!=a.style.backgroundColor&&(-1!==(e=-1!==(e=a.style.backgroundColor).indexOf("rgb")?parseColor(e).hex:e).indexOf("#")&&$("#tableBgColorPicker").val(e),$("#tableBgColor").val(e)),""!=a.style.color&&(-1!==(e=-1!==(e=a.style.color).indexOf("rgb")?parseColor(e).hex:e).indexOf("#")&&$("#tableFontColorPicker").val(e),$("#tableFontColor").val(e)),"0px auto"==a.style.margin?$("#tableCenter").prop("checked",!0):$("#tableCenter").prop("checked",!1),$("#tableFontFamily").val(a.style.fontFamily),$("#tableFontSize").val(a.style.fontSize),$("#cellPadding").val(a.style.padding),$("#cellPadding").prop("data-val",a.style.padding),$("#cellSpacing").val(a.style.borderSpacing),$("#tableWidth").val(a.style.width),$("#tableHeight").val(a.style.height),$("#tableBorderWidthSelect").val(""),$("#tableBorderWidth").val(a.style.borderWidth),t=a.style.borderWidth,$("#tableBorderStyleSelect").val(a.style.borderStyle),t+=" "+a.style.borderStyle,""!=a.style.borderColor&&(-1!==(e=-1!==(e=a.style.borderColor).indexOf("rgb")?parseColor(e).hex:e).indexOf("#")&&$("#tableBorderColorPicker").val(e),$("#tableBorderColor").val(e),t+=" "+e),$("#tableBorderWidth").prop("data-val",t),$("#tableOptionsModal").modal("show")):alert(lajax.t("Please click any table cell first."))}function getFroalaClickedTableElement(){if(null!=froalaClickedElement){for(var e=froalaClickedElement.parentNode.parentNode;null!=e.localName&&"table"!=e.localName&&"body"!=(e=e.parentNode).localName;);if(null!=e&&"table"==e.localName)return e}return null}function setTableOptionsInHtml(){var e=getFroalaClickedTableElement();if(null!=e){e.style.backgroundColor=$("#tableBgColor").val(),e.style.color=$("#tableFontColor").val(),e.style.fontFamily=$("#tableFontFamily").val(),e.style.fontSize=$("#tableFontSize").val(),e.style.padding=$("#cellPadding").val(),e.style.borderSpacing=$("#cellSpacing").val(),""!=$("#cellSpacing").val().trim()?e.style.borderCollapse="separate":e.style.borderCollapse="collapse",e.style.width=$("#tableWidth").val(),e.style.height=$("#tableHeight").val(),$("#tableCenter").prop("checked")?e.style.margin="0 auto":e.style.margin="";var t="";""!=$("#tableBorderStyleSelect").val()||""==$("#tableBorderWidth").val()&&""==$("#tableBorderColor").val()||$("#tableBorderStyleSelect").val("solid"),""!=$("#tableBorderStyleSelect").val()&&(""==$("#tableBorderColor").val()&&$("#tableBorderColor").val("#000000"),t=$("#tableBorderWidth").val(),t+=" "+$("#tableBorderStyleSelect").val(),t+=" "+$("#tableBorderColor").val()),e.style.border=t;for(var a=e.querySelectorAll("td"),o=0;o<a.length;o++){var i=a[o];t!==$("#tableBorderWidth").prop("data-val")&&(i.style.border=t),$("#cellPadding").val()!=$("#cellPadding").prop("data-val")&&(i.style.padding=$("#cellPadding").val())}for(a=e.querySelectorAll("th"),o=0;o<a.length;o++)i=a[o],t!==$("#tableBorderWidth").prop("data-val")&&(i.style.border=t),$("#cellPadding").val()!=$("#cellPadding").prop("data-val")&&(i.style.padding=$("#cellPadding").val());contentChange()}$("#tableOptionsModal").modal("hide")}function tableCellOptionsModal(){var e,t,a=froalaClickedElement;null!=a&&"td"==a.localName?(""!=a.style.backgroundColor&&(-1!==(e=-1!==(e=a.style.backgroundColor).indexOf("rgb")?parseColor(e).hex:e).indexOf("#")&&$("#tableCellBgColorPicker").val(e),$("#tableCellBgColor").val(e)),$("#tableCellPadding").val(a.style.padding),$("#tableCellPadding").prop("data-val",a.style.padding),$("#tableCellBorderWidthSelect").val(""),$("#tableCellBorderWidth").val(a.style.borderWidth),t=a.style.borderWidth,$("#tableCellBorderStyleSelect").val(a.style.borderStyle),t+=" "+a.style.borderStyle,""!=a.style.borderColor&&(-1!==(e=-1!==(e=a.style.borderColor).indexOf("rgb")?parseColor(e).hex:e).indexOf("#")&&$("#tableCellBorderColorPicker").val(e),$("#tableCellBorderColor").val(e),t+=" "+e),$("#tableCellBorderWidth").prop("data-val",t),$("#tableCellOptionsModal").modal("show")):alert(lajax.t("Please click any table cell first."))}function setTableCellOptionsInHtml(){var e,t=froalaClickedElement;null!=t&&"td"==t.localName&&(t.style.backgroundColor=$("#tableCellBgColor").val(),t.style.padding=$("#tableCellPadding").val(),(e="")!=$("#tableCellBorderStyleSelect").val()||""==$("#tableCellBorderWidth").val()&&""==$("#tableCellBorderColor").val()||$("#tableCellBorderStyleSelect").val("solid"),""!=$("#tableCellBorderStyleSelect").val()&&(""==$("#tableCellBorderColor").val()&&$("#tableCellBorderColor").val("#000000"),e=$("#tableCellBorderWidth").val(),e+=" "+$("#tableCellBorderStyleSelect").val(),e+=" "+$("#tableCellBorderColor").val()),t.style.border=e,contentChange()),$("#tableCellOptionsModal").modal("hide")}function responsive_filemanager_callback(e){var t;useTiny||(t=$("#"+e).val(),isR&&1==settings.imageSizeInHtml?(loading(),(e=new Image).onload=function(){var e=' width="'+this.width+'" height="'+this.height+'" ';insertImageInEditor(t,e),loaded()},e.src=t):insertImageInEditor(t," "))}function insertImageInEditor(e,t){$("#embedImages").is(":checked")?toDataUrl(e,function(e){froalaEditor.html.insert('<img src="'+e+'"'+t+'alt="" />'),contentChange()}):(froalaEditor.html.insert('<img src="'+e+"?"+Math.round(1e4*Math.random())+'"'+t+'alt="" />'),contentChange())}function toDataUrl(e,t){var a=new XMLHttpRequest;a.onload=function(){var e=new FileReader;e.onloadend=function(){t(e.result)},e.readAsDataURL(a.response)},a.open("GET",e),a.responseType="blob",a.send()}function setTextShadowInHtml(){froalaEditor.undo.saveStep(),froalaEditor.format.applyStyle("text-shadow",getTextShadowCSSValue()),contentChange(),$("#textShadowModal").modal("hide")}function updateTextShadowPreview(){$("#textShadowPreview").css("text-shadow",getTextShadowCSSValue())}function getTextShadowCSSValue(){return $("#textShadowRight").val()+"px "+$("#textShadowDown").val()+"px "+$("#textShadowBlur").val()+"px "+hexToRGB($("#textShadowColorPicker").val(),$("#textShadowOpacity").val())}function hexToRGB(e,t){var a=parseInt(e.slice(1,3),16),o=parseInt(e.slice(3,5),16),e=parseInt(e.slice(5,7),16);return t?"rgba("+a+", "+o+", "+e+", "+t+")":"rgb("+a+", "+o+", "+e+")"}function switchEditors(){useTiny?(trackEvent("Switch to Froala Editor","click"),onlyShowVisualEditorMode?window.location="/html-editor-online/new-editor":window.location="/site/new-editor"):(trackEvent("Switch to TinyMCE Editor","click"),onlyShowVisualEditorMode?window.location="/html-editor-online/tiny-editor":window.location="/site/tiny-editor")}function switchVisualToHTMLEditor(){onlyShowVisualEditorMode?($("#code").show(),$("#leftEditorBigger").show(),$("#rightEditorBigger").show(),$("#uploadAndConvertWrapper").show(),$("#visualEditor").removeClass("col-lg-12"),$("#visualEditor").removeClass("col-lg-10"),$("#visualEditor").removeClass("col-lg-offset-1"),$("#visualEditor").addClass("col-lg-6"),$("#copyToClipboardButton").hide(),onlyShowVisualEditorMode=!1,trackEvent("Show HTML editor","click")):(showOnlyVisualEditor(),onlyShowVisualEditorMode=!0,trackEvent("Hide HTML editor","click"))}function showOnlyVisualEditor(){$("#code").css("display","none"),$("#leftEditorBigger").css("display","none"),$("#rightEditorBigger").css("display","none"),$("#uploadAndConvertWrapper").css("display","none"),$("#visualEditor").removeClass("col-lg-6"),$("#visualEditor").addClass("col-lg-offset-1"),$("#visualEditor").addClass("col-lg-10"),$("#copyToClipboardButton").show(),$("#cleanupTabs").is(":visible")&&($("#cleanupTabs").fadeOut(),cleanupShown=!1,settings.showCleanupOptions=0)}function showImageEditor(){if(null!=froalaClickedElement&&"IMG"==froalaClickedElement.tagName){var o=froalaClickedElement,e="",e=o.src.startsWith(WTH_MEDIA_URL)||o.src.startsWith("data")?o.src:"/proxy.php?url="+o.src,{TABS:t,TOOLS:a}=FilerobotImageEditor,a={source:e,language:language,closeAfterSave:!0,useZoomPresetsMenu:!1,forceToPngInEllipticalCrop:!0,observePluginContainerSize:!0,theme:{typography:{fontFamily:"Lato, Arial"}},onModify:e=>{},onSave:(a,e)=>{$("#embedImages").is(":checked")?(o.src=a.imageBase64,o.width=a.width,o.height=a.height,contentChange()):imageConversion.dataURLtoFile(a.imageBase64).then(e=>{var t=new FormData;t.append("file",e),$.ajax({url:"/site/upload-image",type:"POST",data:t,processData:!1,contentType:!1,success:function(e){e=JSON.parse(e);o.src=e.link,o.width=a.width,o.height=a.height,contentChange()},error:function(e,t,a){console.log(e),console.log(a)}})}),$("#imageEditorModal").modal("hide")},annotationsCommon:{fill:"#ff0000"},Text:{text:"Lore ipsum..."},translations:{profile:"Profile",coverPhoto:"Cover photo",facebook:"Facebook",socialMedia:"Social Media",fbProfileSize:"180x180px",fbCoverPhotoSize:"820x312px"},Crop:{presetsItems:[{titleKey:"classicTv",descriptionKey:"4:3",ratio:4/3},{titleKey:"cinemascope",descriptionKey:"21:9",ratio:21/9}],presetsFolders:[{titleKey:"socialMedia",groups:[{titleKey:"facebook",items:[{titleKey:"profile",width:180,height:180,descriptionKey:"fbProfileSize"},{titleKey:"coverPhoto",width:820,height:312,descriptionKey:"fbCoverPhotoSize"}]}]}]},tabsIds:[t.RESIZE,t.ADJUST,t.FILTERS,t.FINETUNE,t.ANNOTATE,t.WATERMARK],defaultTabId:t.RESIZE,defaultToolId:a.TEXT};$("#imageEditorModal").modal("show");const i=new FilerobotImageEditor(document.querySelector("#img_editor_container"),a);i.render({onClose:e=>{console.log("Closing reason",e),i.terminate()}})}else alert(lajax.t("Please select or click an image first"))}function resizeImageViaTimeout(){0<updateTimeoutID&&(clearTimeout(updateTimeoutID),updateTimeoutID=0),updateTimeoutID=setTimeout(resizeInputImage,250)}function resizeInputImage(){clearTimeout(updateTimeoutID),updateTimeoutID=0;var e=inputImageToResize.type;$("#jpegMode").bootstrapSwitch("state")&&(e="image/jpeg");var t=$("#imageSizeSlider").val()/100,a=Math.round(inputImageWidth*t),o=Math.round(inputImageHeight*t);resizedImageWidth=a,resizedImageHeight=o;t=document.createElement("canvas");t.width=a,t.height=o,t.getContext("2d").drawImage(inputImageElement,0,0,a,o);t=t.toDataURL(e,$("#jpgQualitySlider").val()/100),e=document.getElementById("imageToResize");e.src=t,e.width=a,e.height=o,imageConversion.dataURLtoFile(t).then(e=>{resizedInputImage=e,$("#imageSizeInfo").html(lajax.t("Original image {w}px/{h}px file size {s} vs resized {r} {p}% {rw}px/{rh}px - {x} times smaller",{w:inputImageWidth,h:inputImageHeight,s:humanFileSize(inputImageToResize.size),r:humanFileSize(resizedInputImage.size),rw:a,rh:o,p:$("#imageSizeSlider").val(),x:Math.round(inputImageToResize.size/resizedInputImage.size)}))})}function insertImageIntoEditor(e,t,a){null!=imageToResizeInEditor&&(imageToResizeInEditor.css("width",""),imageToResizeInEditor.css("height","")),$("#embedImages").is(":checked")||!1===isR?imageConversion.filetoDataURL(e).then(e=>{null!=imageToResizeInEditor?(imageToResizeInEditor[0].src=e,1==settings.imageSizeInHtml?(imageToResizeInEditor[0].width=t,imageToResizeInEditor[0].height=a):(imageToResizeInEditor.removeAttr("width"),imageToResizeInEditor.removeAttr("height")),contentChange()):froalaEditor.image.insert(e,null,null,null),imageToResizeInEditor=null,setTimeout(function(){froalaEditor.popups.hideAll()},500)}):uploadImageAjax(e,imageToResizeInEditor,t,a)}function insertOriginalImage(){insertImageIntoEditor(inputImageToResize,inputImageWidth,inputImageHeight),trackEvent("Make image files smaller","click","Insert original image")}function insertResizedImage(){insertImageIntoEditor(resizedInputImage,resizedImageWidth,resizedImageHeight),trackEvent("Make image files smaller","click","Insert resized image")}function getImageWitdthResizeFactor(e){var t=Math.round(.8*getBrowserWidth()),e=Math.round(t/e*100);return e=80<e?80:e}function resizeImageModal(){var e="";null!=froalaClickedElement&&"IMG"==froalaClickedElement.tagName?(e=froalaClickedElement.src.startsWith(WTH_MEDIA_URL)||froalaClickedElement.src.startsWith("data")?froalaClickedElement.src:"/proxy.php?url="+froalaClickedElement.src,null==imageToResizeInEditor&&(imageToResizeInEditor=froalaEditor.image.get()),imageConversion.urltoBlob(e).then(e=>{inputImageToResize=e,(inputImageElement=new Image).onload=function(){inputImageWidth=this.width,inputImageHeight=this.height,$("#imageSizeSlider").slider("setValue",getImageWitdthResizeFactor(this.width)),"image/jpeg"==inputImageToResize.type?($("#jpegQualityDiv").fadeIn(),$("#jpegModeDiv").fadeOut()):("image/webp"==inputImageToResize.type?$("#jpegQualityDiv").fadeIn():$("#jpegQualityDiv").fadeOut(),$("#jpegModeDiv").fadeIn(),$("#jpegMode").prop("checked",!1).change()),$("#imageResizeTopInfo").hide(),$("#insertOriginalImageButton").hide(),$("#imageResizeModal").modal("show"),resizeInputImage()},inputImageElement.src=URL.createObjectURL(e)})):alert(lajax.t("Please select or click an image first"))}function showAIModal(){var e=getVisualEditorSelectedText();0<e.trim().length&&$("#aipromptform-prompt").val(e),$("#aiModal").modal("show")}function getVisualEditorSelectedText(){var e="";return e=useTiny&&!1===tinymce.activeEditor.selection.isCollapsed()||!useTiny&&!1===froalaEditor.selection.isCollapsed()?useTiny?tinymce.activeEditor.selection.getContent({format:"text"}):froalaEditor.selection.text():e}function getVisualEditorSelectedOrAllText(){return(useTiny&&tinymce.activeEditor.selection.isCollapsed()||!useTiny&&froalaEditor.selection.isCollapsed())&&selectAllVisualEditorContent(),getVisualEditorSelectedText()}function selectAllVisualEditorContent(){useTiny?tinymce.activeEditor.execCommand("SelectAll"):froalaEditor.commands.selectAll()}function getVisualEditorSelectedHtml(){var e="";return e=useTiny&&!1===tinymce.activeEditor.selection.isCollapsed()||!useTiny&&!1===froalaEditor.selection.isCollapsed()?useTiny?tinymce.activeEditor.selection.getContent():froalaEditor.html.getSelected():e}function getVisualEditorSelectedOrAllHtml(){return(useTiny&&tinymce.activeEditor.selection.isCollapsed()||!useTiny&&froalaEditor.selection.isCollapsed())&&selectAllVisualEditorContent(),getVisualEditorSelectedHtml()}